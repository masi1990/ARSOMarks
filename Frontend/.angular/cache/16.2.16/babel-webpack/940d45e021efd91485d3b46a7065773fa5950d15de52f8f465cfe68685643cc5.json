{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { UserRole } from '../../shared/models/user.model';\nexport let RoleDashboardsComponent = class RoleDashboardsComponent {\n  constructor(analytics, authService, route, router) {\n    this.analytics = analytics;\n    this.authService = authService;\n    this.route = route;\n    this.router = router;\n    this.UserRole = UserRole;\n    this.roleOptions = Object.values(UserRole);\n    this.selectedRole = UserRole.SUPER_ADMIN;\n    this.loading = false;\n    this.error = '';\n    this.region = '';\n    this.scheme = '';\n    this.timeframe = '90d';\n    this.steps = [];\n  }\n  ngOnInit() {\n    this.sub = this.route.paramMap.subscribe(params => {\n      const roleParam = params.get('role');\n      const resolvedRole = this.resolveRole(roleParam);\n      if (resolvedRole !== this.selectedRole) {\n        this.selectedRole = resolvedRole;\n      }\n      this.loadDashboard();\n    });\n  }\n  ngOnDestroy() {\n    this.sub?.unsubscribe();\n  }\n  canView(role) {\n    const user = this.authService.currentUserValue;\n    const userRoles = user?.roles || (user?.role ? [user.role] : []);\n    return role === UserRole.SUPER_ADMIN || userRoles.includes(UserRole.SUPER_ADMIN) || userRoles.includes(role);\n  }\n  onRoleChange(role) {\n    if (!this.canView(role)) return;\n    this.router.navigate(['/portal/dashboards', role.toLowerCase()]);\n  }\n  applyFilters() {\n    this.loadDashboard();\n  }\n  loadDashboard() {\n    this.error = '';\n    this.loading = true;\n    this.analytics.getDashboard(this.selectedRole, {\n      region: this.region,\n      scheme: this.scheme,\n      startDate: undefined,\n      endDate: undefined\n    }).subscribe({\n      next: data => {\n        this.data = data;\n        this.steps = this.getStepHints(this.selectedRole);\n        this.loading = false;\n      },\n      error: err => {\n        this.error = err?.error?.message || 'Unable to load dashboard data.';\n        this.loading = false;\n      }\n    });\n  }\n  resolveRole(roleParam) {\n    if (roleParam && this.canView(roleParam)) {\n      return roleParam;\n    }\n    const user = this.authService.currentUserValue;\n    const userRoles = user?.roles || (user?.role ? [user.role] : []);\n    if (userRoles.includes(UserRole.SUPER_ADMIN)) return UserRole.SUPER_ADMIN;\n    return userRoles[0] || UserRole.OPERATOR;\n  }\n  getStepHints(role) {\n    const shared = ['Review alerts and pending actions', 'Drill into breakdowns by region and scheme'];\n    const map = {\n      [UserRole.SUPER_ADMIN]: ['Switch roles to audit coverage', 'Export reports where needed', ...shared],\n      [UserRole.ARSO_COUNCIL]: ['Review strategic KPIs', 'Approve schemes/policies requiring action', ...shared],\n      [UserRole.CACO_MEMBER]: ['Validate scheme queue', 'Check IAF MD 25 alignment flags', ...shared],\n      [UserRole.ARSO_SECRETARIAT]: ['Check system health & audit logs', 'Review pending approvals and payments', ...shared],\n      [UserRole.ADVISORY_COMMITTEE]: ['Address conflict resolution queue', 'Record advisory outcomes', ...shared],\n      [UserRole.SMC_MEMBER]: ['Track harmonization progress', 'Log SHP-01 compliance notes', ...shared],\n      [UserRole.NSB_ADMIN]: ['Check operator registry progress', 'Monitor CB oversight items', ...shared],\n      [UserRole.NSB_USER]: ['Work through assigned tasks', 'Complete operator registrations', ...shared],\n      [UserRole.CB_ADMIN]: ['Check audit schedule', 'Prioritize certificates expiring soon', ...shared],\n      [UserRole.CB_USER]: ['Complete assigned audits/checklists', 'Upload evidence and reports', ...shared],\n      [UserRole.OPERATOR]: ['Check certificate status and NCs', 'Submit docs/self-audits on time', ...shared],\n      [UserRole.ACCREDITATION_BODY]: ['Review CB scopes and surveillance schedule', 'Track AFRAC MRA compliance alerts', ...shared],\n      [UserRole.PUBLIC]: ['Browse certified products', 'Submit public complaints if needed', ...shared]\n    };\n    return map[role] || shared;\n  }\n};\nRoleDashboardsComponent = __decorate([Component({\n  selector: 'app-role-dashboards',\n  templateUrl: './role-dashboards.component.html',\n  styleUrls: ['./role-dashboards.component.scss']\n})], RoleDashboardsComponent);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}