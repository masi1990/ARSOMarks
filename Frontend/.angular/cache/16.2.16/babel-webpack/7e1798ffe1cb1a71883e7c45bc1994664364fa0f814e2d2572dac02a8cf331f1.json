{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../nsb-management/services/country.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nfunction CountryListComponent_option_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const region_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", region_r5.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(region_r5.name);\n  }\n}\nfunction CountryListComponent_option_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const rec_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", rec_r6.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(rec_r6.name);\n  }\n}\nfunction CountryListComponent_button_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function CountryListComponent_button_32_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.cancelEdit());\n    });\n    i0.ɵɵtext(1, \"Cancel\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CountryListComponent_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.error);\n  }\n}\nfunction CountryListComponent_tr_48_span_8_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const rec_r11 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", rec_r11.name, \" \");\n  }\n}\nfunction CountryListComponent_tr_48_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtemplate(1, CountryListComponent_tr_48_span_8_ng_container_1_Template, 2, 1, \"ng-container\", 21);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const rec_r11 = ctx.$implicit;\n    const country_r9 = i0.ɵɵnextContext().$implicit;\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r10.hasRec(country_r9, rec_r11.id));\n  }\n}\nfunction CountryListComponent_tr_48_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtemplate(8, CountryListComponent_tr_48_span_8_Template, 2, 1, \"span\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function CountryListComponent_tr_48_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const country_r9 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.startEdit(country_r9));\n    });\n    i0.ɵɵtext(11, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function CountryListComponent_tr_48_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const country_r9 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.delete(country_r9));\n    });\n    i0.ɵɵtext(13, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const country_r9 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(country_r9.isoCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(country_r9.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r4.getRegionName(country_r9.regionId));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.recs);\n  }\n}\nexport let CountryListComponent = /*#__PURE__*/(() => {\n  class CountryListComponent {\n    constructor(countryService, fb) {\n      this.countryService = countryService;\n      this.fb = fb;\n      this.countries = [];\n      this.regions = [];\n      this.recs = [];\n      this.editingId = null;\n      this.loading = false;\n      this.error = '';\n      this.form = this.fb.group({\n        isoCode: ['', [Validators.required, Validators.minLength(2), Validators.maxLength(2)]],\n        name: ['', Validators.required],\n        regionId: ['', Validators.required],\n        recIds: [[]],\n        continent: ['']\n      });\n    }\n    ngOnInit() {\n      this.load();\n      this.loadRegions();\n      this.loadRecs();\n    }\n    load() {\n      this.loading = true;\n      this.countryService.getCountries().subscribe({\n        next: data => {\n          this.countries = data || [];\n          this.loading = false;\n        },\n        error: () => {\n          this.error = 'Failed to load countries';\n          this.loading = false;\n        }\n      });\n    }\n    loadRegions() {\n      this.countryService.getRegions().subscribe({\n        next: data => this.regions = data || [],\n        error: () => this.regions = []\n      });\n    }\n    loadRecs() {\n      this.countryService.getRecs().subscribe({\n        next: data => this.recs = data || [],\n        error: () => this.recs = []\n      });\n    }\n    startEdit(country) {\n      this.editingId = country.id;\n      this.form.patchValue({\n        isoCode: country.isoCode,\n        name: country.name,\n        regionId: country.regionId,\n        continent: country.continent,\n        recIds: country.recIds || []\n      });\n    }\n    cancelEdit() {\n      this.editingId = null;\n      this.form.reset({\n        recIds: []\n      });\n    }\n    submit() {\n      if (this.form.invalid) return;\n      this.loading = true;\n      const payload = this.form.value;\n      const obs = this.editingId ? this.countryService.updateCountry(this.editingId, payload) : this.countryService.createCountry(payload);\n      obs.subscribe({\n        next: () => {\n          this.cancelEdit();\n          this.load();\n        },\n        error: () => {\n          this.error = 'Save failed';\n          this.loading = false;\n        }\n      });\n    }\n    delete(country) {\n      if (!confirm(`Delete country ${country.name}?`)) return;\n      this.countryService.deleteCountry(country.id).subscribe({\n        next: () => this.load(),\n        error: () => this.error = 'Delete failed'\n      });\n    }\n    trackById(_, item) {\n      return item.id;\n    }\n    getRegionName(regionId) {\n      return this.regions.find(r => r.id === regionId)?.name || '';\n    }\n    hasRec(country, recId) {\n      const recIds = country.recIds;\n      return Array.isArray(recIds) ? recIds.includes(recId) : false;\n    }\n    static {\n      this.ɵfac = function CountryListComponent_Factory(t) {\n        return new (t || CountryListComponent)(i0.ɵɵdirectiveInject(i1.CountryService), i0.ɵɵdirectiveInject(i2.FormBuilder));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: CountryListComponent,\n        selectors: [[\"app-country-list\"]],\n        decls: 49,\n        vars: 8,\n        consts: [[1, \"page\"], [1, \"card\"], [1, \"form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"row\"], [\"formControlName\", \"isoCode\"], [\"formControlName\", \"name\"], [\"formControlName\", \"regionId\"], [\"value\", \"\", \"disabled\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"multiple\", \"\", \"formControlName\", \"recIds\"], [\"formControlName\", \"continent\"], [1, \"actions\"], [\"type\", \"submit\", 3, \"disabled\"], [\"type\", \"button\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"error\", 4, \"ngIf\"], [1, \"table\"], [4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"type\", \"button\", 3, \"click\"], [1, \"error\"], [3, \"click\"], [4, \"ngIf\"]],\n        template: function CountryListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"Countries\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"div\", 1)(4, \"form\", 2);\n            i0.ɵɵlistener(\"ngSubmit\", function CountryListComponent_Template_form_ngSubmit_4_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵelementStart(5, \"div\", 3)(6, \"label\");\n            i0.ɵɵtext(7, \"ISO Code\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(8, \"input\", 4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"div\", 3)(10, \"label\");\n            i0.ɵɵtext(11, \"Name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(12, \"input\", 5);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"div\", 3)(14, \"label\");\n            i0.ɵɵtext(15, \"Region\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(16, \"select\", 6)(17, \"option\", 7);\n            i0.ɵɵtext(18, \"Select region\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(19, CountryListComponent_option_19_Template, 2, 2, \"option\", 8);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(20, \"div\", 3)(21, \"label\");\n            i0.ɵɵtext(22, \"RECs (multi-select)\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"select\", 9);\n            i0.ɵɵtemplate(24, CountryListComponent_option_24_Template, 2, 2, \"option\", 8);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(25, \"div\", 3)(26, \"label\");\n            i0.ɵɵtext(27, \"Continent\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(28, \"input\", 10);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(29, \"div\", 11)(30, \"button\", 12);\n            i0.ɵɵtext(31);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(32, CountryListComponent_button_32_Template, 2, 0, \"button\", 13);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(33, CountryListComponent_div_33_Template, 2, 1, \"div\", 14);\n            i0.ɵɵelementStart(34, \"table\", 15)(35, \"thead\")(36, \"tr\")(37, \"th\");\n            i0.ɵɵtext(38, \"ISO\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"th\");\n            i0.ɵɵtext(40, \"Name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(41, \"th\");\n            i0.ɵɵtext(42, \"Region\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(43, \"th\");\n            i0.ɵɵtext(44, \"RECs\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(45, \"th\");\n            i0.ɵɵtext(46, \"Actions\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(47, \"tbody\");\n            i0.ɵɵtemplate(48, CountryListComponent_tr_48_Template, 14, 4, \"tr\", 16);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"formGroup\", ctx.form);\n            i0.ɵɵadvance(15);\n            i0.ɵɵproperty(\"ngForOf\", ctx.regions);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngForOf\", ctx.recs);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"disabled\", ctx.loading || ctx.form.invalid);\n            i0.ɵɵadvance(1);\n            i0.ɵɵtextInterpolate(ctx.editingId ? \"Update\" : \"Create\");\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.editingId);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(15);\n            i0.ɵɵproperty(\"ngForOf\", ctx.countries);\n          }\n        },\n        dependencies: [i3.NgForOf, i3.NgIf, i2.ɵNgNoValidate, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.SelectControlValueAccessor, i2.SelectMultipleControlValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName],\n        styles: [\".page[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto;padding:10px}.card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;padding:16px;margin-bottom:16px;border-radius:8px}.form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:10px}label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:8px;border:1px solid #d0d0d0;border-radius:4px}.actions[_ngcontent-%COMP%]{display:flex;gap:10px}button[_ngcontent-%COMP%]{padding:8px 12px;border:none;border-radius:4px;background:#2c3e50;color:#fff;cursor:pointer}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;border:1px solid #e0e0e0}.error[_ngcontent-%COMP%]{color:#c0392b;margin-bottom:10px}\"]\n      });\n    }\n  }\n  return CountryListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}