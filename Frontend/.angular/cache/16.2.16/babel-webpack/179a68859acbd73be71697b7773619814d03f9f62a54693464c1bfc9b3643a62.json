{"ast":null,"code":"import { finalize } from 'rxjs';\nimport { NsbRegistrationRequestStatus } from '../../shared/models/nsb-registration-request.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../modules/nsb-management/services/nsb-registration-request.service\";\nimport * as i3 from \"../../modules/nsb-management/services/nsb.service\";\nimport * as i4 from \"../../modules/auth/services/auth.service\";\nexport let NsbDashboardComponent = /*#__PURE__*/(() => {\n  class NsbDashboardComponent {\n    constructor(router, requestService, nsbService, authService) {\n      this.router = router;\n      this.requestService = requestService;\n      this.nsbService = nsbService;\n      this.authService = authService;\n      this.loading = false;\n      this.error = '';\n      this.user = null;\n      this.registrationRequest = null;\n      this.nsb = null;\n    }\n    ngOnInit() {\n      this.user = this.authService.currentUserValue;\n      this.loadData();\n    }\n    loadData() {\n      this.loading = true;\n      this.error = '';\n      // Load registration request if user has countryId\n      if (this.user?.countryId) {\n        this.requestService.getMyRequest(this.user.countryId).pipe(finalize(() => {\n          this.loading = false;\n        })).subscribe({\n          next: request => {\n            this.registrationRequest = request;\n            // If approved, load NSB\n            if (request?.status === NsbRegistrationRequestStatus.APPROVED && request.nsbId) {\n              this.loadNsb(request.nsbId);\n            }\n          },\n          error: err => {\n            // No request found is OK\n            if (err.status !== 404) {\n              this.error = 'Failed to load registration request.';\n            }\n          }\n        });\n      } else {\n        this.loading = false;\n      }\n      // Also try to load NSB directly (for users who already have NSB)\n      this.nsbService.getMyNsb().pipe(finalize(() => {\n        // Don't set loading to false here, let the request loading handle it\n      })).subscribe({\n        next: nsb => {\n          this.nsb = nsb;\n        },\n        error: () => {\n          // No NSB found is OK\n        }\n      });\n    }\n    loadNsb(nsbId) {\n      this.nsbService.getNsbById(nsbId).subscribe({\n        next: nsb => {\n          this.nsb = nsb;\n        },\n        error: () => {\n          // Error loading NSB\n        }\n      });\n    }\n    getStatusColor(status) {\n      switch (status) {\n        case 'DRAFT':\n          return 'bg-slate-100 text-slate-700';\n        case 'SUBMITTED':\n        case 'UNDER_REVIEW':\n          return 'bg-blue-100 text-blue-700';\n        case 'APPROVED':\n          return 'bg-emerald-100 text-emerald-700';\n        case 'REJECTED':\n          return 'bg-red-100 text-red-700';\n        default:\n          return 'bg-slate-100 text-slate-700';\n      }\n    }\n    getStatusLabel(status) {\n      switch (status) {\n        case 'DRAFT':\n          return 'Draft';\n        case 'SUBMITTED':\n          return 'Submitted for Review';\n        case 'UNDER_REVIEW':\n          return 'Under Review';\n        case 'APPROVED':\n          return 'Approved';\n        case 'REJECTED':\n          return 'Rejected';\n        default:\n          return status;\n      }\n    }\n    goToRegistrationRequest() {\n      this.router.navigate(['/nsb-registration/request']);\n    }\n    goToProfileSetup() {\n      this.router.navigate(['/nsb/profile-setup']);\n    }\n    canCompleteProfile() {\n      return this.registrationRequest?.status === NsbRegistrationRequestStatus.APPROVED && !this.nsb;\n    }\n    canEditRegistrationRequest() {\n      return this.registrationRequest?.status === NsbRegistrationRequestStatus.DRAFT;\n    }\n    canSubmitRegistrationRequest() {\n      return this.registrationRequest?.status === NsbRegistrationRequestStatus.DRAFT;\n    }\n    static {\n      this.ɵfac = function NsbDashboardComponent_Factory(t) {\n        return new (t || NsbDashboardComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.NsbRegistrationRequestService), i0.ɵɵdirectiveInject(i3.NsbService), i0.ɵɵdirectiveInject(i4.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: NsbDashboardComponent,\n        selectors: [[\"app-nsb-dashboard\"]],\n        decls: 0,\n        vars: 0,\n        template: function NsbDashboardComponent_Template(rf, ctx) {},\n        styles: [\"(()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  {// webpackBootstrap \\\"use strict\\\";})()[_ngcontent-%COMP%] ;{%BLOCK%}\"]\n      });\n    }\n  }\n  return NsbDashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}