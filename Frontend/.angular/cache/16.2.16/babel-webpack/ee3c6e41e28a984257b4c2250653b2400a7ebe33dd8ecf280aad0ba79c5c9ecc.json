{"ast":null,"code":"import { finalize } from 'rxjs';\nimport { RoleRequestStatus } from '../../shared/models/user.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../modules/auth/services/auth.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction RoleAdminComponent_span_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 15);\n    i0.ɵɵtext(1, \"Loading\\u2026\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction RoleAdminComponent_div_20_div_1_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const req_r7 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\\u00B7 \", req_r7.user == null ? null : req_r7.user.email, \"\");\n  }\n}\nfunction RoleAdminComponent_div_20_div_1_span_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const req_r7 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\\u00B7 Reviewed: \", i0.ɵɵpipeBind2(2, 1, req_r7.reviewedAt, \"medium\"), \"\");\n  }\n}\nfunction RoleAdminComponent_div_20_div_1_p_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 15);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const req_r7 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Note: \", req_r7.decisionNote, \"\");\n  }\n}\nfunction RoleAdminComponent_div_20_div_1_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 28)(1, \"input\", 29);\n    i0.ɵɵlistener(\"ngModelChange\", function RoleAdminComponent_div_20_div_1_div_16_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const req_r7 = i0.ɵɵnextContext().$implicit;\n      const ctx_r15 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r15.decisionNotes[req_r7.id] = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 30)(3, \"button\", 31);\n    i0.ɵɵlistener(\"click\", function RoleAdminComponent_div_20_div_1_div_16_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const req_r7 = i0.ɵɵnextContext().$implicit;\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r18.decide(req_r7, \"APPROVED\"));\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function RoleAdminComponent_div_20_div_1_div_16_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const req_r7 = i0.ɵɵnextContext().$implicit;\n      const ctx_r20 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r20.decide(req_r7, \"REJECTED\"));\n    });\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const req_r7 = i0.ɵɵnextContext().$implicit;\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r11.decisionNotes[req_r7.id]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r11.decidingId === req_r7.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r11.decidingId === req_r7.id ? \"Saving\\u2026\" : \"Approve\", \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r11.decidingId === req_r7.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r11.decidingId === req_r7.id ? \"Saving\\u2026\" : \"Reject\", \" \");\n  }\n}\nfunction RoleAdminComponent_div_20_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"div\", 2)(2, \"div\", 22)(3, \"p\", 23);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 15);\n    i0.ɵɵtext(6);\n    i0.ɵɵtemplate(7, RoleAdminComponent_div_20_div_1_span_7_Template, 2, 1, \"span\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\", 15);\n    i0.ɵɵtext(9);\n    i0.ɵɵpipe(10, \"date\");\n    i0.ɵɵtemplate(11, RoleAdminComponent_div_20_div_1_span_11_Template, 3, 4, \"span\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(12, RoleAdminComponent_div_20_div_1_p_12_Template, 2, 1, \"p\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 25)(14, \"span\", 26);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(16, RoleAdminComponent_div_20_div_1_div_16_Template, 7, 5, \"div\", 27);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const req_r7 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r4.formatRolesList(req_r7.requestedRoles));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" User: \", (req_r7.user == null ? null : req_r7.user.fullName) || req_r7.userId, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", req_r7.user == null ? null : req_r7.user.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Created: \", i0.ɵɵpipeBind2(10, 9, req_r7.createdAt, \"medium\"), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", req_r7.reviewedAt);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", req_r7.decisionNote);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", ctx_r4.statusBadgeClasses(req_r7.status));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(req_r7.status);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", req_r7.status === \"PENDING\");\n  }\n}\nfunction RoleAdminComponent_div_20_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r5.decisionError);\n  }\n}\nfunction RoleAdminComponent_div_20_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 34);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r6.decisionSuccess);\n  }\n}\nfunction RoleAdminComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtemplate(1, RoleAdminComponent_div_20_div_1_Template, 17, 12, \"div\", 17);\n    i0.ɵɵelementStart(2, \"div\", 18);\n    i0.ɵɵtemplate(3, RoleAdminComponent_div_20_span_3_Template, 2, 1, \"span\", 19);\n    i0.ɵɵtemplate(4, RoleAdminComponent_div_20_span_4_Template, 2, 1, \"span\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.requests);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.decisionError);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.decisionSuccess);\n  }\n}\nfunction RoleAdminComponent_ng_template_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 35);\n    i0.ɵɵtext(1, \"No role requests found.\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let RoleAdminComponent = /*#__PURE__*/(() => {\n  class RoleAdminComponent {\n    constructor(authService) {\n      this.authService = authService;\n      this.requests = [];\n      this.loading = false;\n      this.decidingId = null;\n      this.decisionError = '';\n      this.decisionSuccess = '';\n      this.decisionNotes = {};\n    }\n    ngOnInit() {\n      this.load();\n    }\n    load() {\n      this.loading = true;\n      this.authService.listRoleRequests().pipe(finalize(() => {\n        this.loading = false;\n      })).subscribe({\n        next: reqs => {\n          this.requests = reqs || [];\n        },\n        error: err => {\n          this.requests = [];\n          this.decisionError = err?.error?.message || 'Failed to load requests.';\n        }\n      });\n    }\n    decide(req, status) {\n      this.decisionError = '';\n      this.decisionSuccess = '';\n      this.decidingId = req.id;\n      const payload = {\n        status,\n        note: this.decisionNotes[req.id]?.trim() || undefined\n      };\n      this.authService.decideRoleRequest(req.id, payload).pipe(finalize(() => {\n        this.decidingId = null;\n      })).subscribe({\n        next: res => {\n          this.requests = this.requests.map(r => r.id === res.id ? res : r);\n          this.decisionSuccess = `Request ${status.toLowerCase()}.`;\n        },\n        error: err => {\n          this.decisionError = err?.error?.message || 'Action failed.';\n        }\n      });\n    }\n    formatRole(role) {\n      return (role || '').toString().replace(/_/g, ' ') || 'N/A';\n    }\n    formatRolesList(roles) {\n      return roles && roles.length ? roles.map(r => this.formatRole(r)).join(', ') : 'None';\n    }\n    statusBadgeClasses(status) {\n      switch (status) {\n        case RoleRequestStatus.APPROVED:\n          return 'bg-emerald-50 text-emerald-700';\n        case RoleRequestStatus.REJECTED:\n          return 'bg-rose-50 text-rose-700';\n        default:\n          return 'bg-amber-50 text-amber-700';\n      }\n    }\n    static {\n      this.ɵfac = function RoleAdminComponent_Factory(t) {\n        return new (t || RoleAdminComponent)(i0.ɵɵdirectiveInject(i1.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: RoleAdminComponent,\n        selectors: [[\"app-role-admin\"]],\n        decls: 23,\n        vars: 5,\n        consts: [[1, \"space-y-6\"], [1, \"card-surface\", \"px-6\", \"py-6\"], [1, \"flex\", \"flex-wrap\", \"items-start\", \"justify-between\", \"gap-3\"], [1, \"space-y-2\"], [1, \"text-xs\", \"font-semibold\", \"uppercase\", \"tracking-[0.14em]\", \"text-slate-500\"], [1, \"text-2xl\", \"font-semibold\", \"text-slate-900\"], [1, \"max-w-3xl\", \"text-sm\", \"text-slate-600\"], [1, \"rounded-xl\", \"bg-slate-900\", \"px-4\", \"py-2.5\", \"text-sm\", \"font-semibold\", \"text-white\", \"shadow-sm\", \"transition\", \"hover:bg-slate-800\", \"disabled:opacity-60\", 3, \"disabled\", \"click\"], [1, \"card-surface\", \"p-6\"], [1, \"flex\", \"items-center\", \"justify-between\", \"gap-3\"], [1, \"text-xs\", \"font-semibold\", \"uppercase\", \"tracking-[0.12em]\", \"text-slate-500\"], [1, \"text-lg\", \"font-semibold\", \"text-slate-900\"], [\"class\", \"text-xs text-slate-500\", 4, \"ngIf\"], [\"class\", \"mt-4 space-y-3\", 4, \"ngIf\", \"ngIfElse\"], [\"emptyQueue\", \"\"], [1, \"text-xs\", \"text-slate-500\"], [1, \"mt-4\", \"space-y-3\"], [\"class\", \"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-800 shadow-sm\", 4, \"ngFor\", \"ngForOf\"], [1, \"flex\", \"flex-wrap\", \"gap-3\", \"text-xs\"], [\"class\", \"text-rose-600\", 4, \"ngIf\"], [\"class\", \"text-emerald-600\", 4, \"ngIf\"], [1, \"rounded-2xl\", \"border\", \"border-slate-200\", \"bg-slate-50\", \"px-4\", \"py-3\", \"text-sm\", \"text-slate-800\", \"shadow-sm\"], [1, \"space-y-1\"], [1, \"font-semibold\"], [4, \"ngIf\"], [1, \"flex\", \"flex-col\", \"items-end\", \"gap-2\"], [1, \"chip\", 3, \"ngClass\"], [\"class\", \"flex flex-wrap justify-end gap-2\", 4, \"ngIf\"], [1, \"flex\", \"flex-wrap\", \"justify-end\", \"gap-2\"], [\"placeholder\", \"Decision note (optional)\", 1, \"w-full\", \"min-w-[180px]\", \"rounded-lg\", \"border\", \"border-slate-200\", \"bg-white\", \"px-2\", \"py-1\", \"text-xs\", \"text-slate-800\", \"focus:border-slate-400\", \"focus:outline-none\", 3, \"ngModel\", \"ngModelChange\"], [1, \"flex\", \"gap-2\"], [1, \"rounded-lg\", \"bg-emerald-600\", \"px-3\", \"py-1.5\", \"text-xs\", \"font-semibold\", \"text-white\", \"shadow-sm\", \"hover:bg-emerald-700\", \"disabled:opacity-60\", 3, \"disabled\", \"click\"], [1, \"rounded-lg\", \"bg-rose-600\", \"px-3\", \"py-1.5\", \"text-xs\", \"font-semibold\", \"text-white\", \"shadow-sm\", \"hover:bg-rose-700\", \"disabled:opacity-60\", 3, \"disabled\", \"click\"], [1, \"text-rose-600\"], [1, \"text-emerald-600\"], [1, \"mt-3\", \"text-sm\", \"text-slate-500\"]],\n        template: function RoleAdminComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"section\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"p\", 4);\n            i0.ɵɵtext(5, \"User roles\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(6, \"h1\", 5);\n            i0.ɵɵtext(7, \"Role requests\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"p\", 6);\n            i0.ɵɵtext(9, \" Approve or reject role requests from users. Decisions are emailed automatically. \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(10, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function RoleAdminComponent_Template_button_click_10_listener() {\n              return ctx.load();\n            });\n            i0.ɵɵtext(11);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(12, \"section\", 8)(13, \"div\", 9)(14, \"div\")(15, \"p\", 10);\n            i0.ɵɵtext(16, \"Queue\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"h3\", 11);\n            i0.ɵɵtext(18, \"All requests\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(19, RoleAdminComponent_span_19_Template, 2, 0, \"span\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(20, RoleAdminComponent_div_20_Template, 5, 3, \"div\", 13);\n            i0.ɵɵtemplate(21, RoleAdminComponent_ng_template_21_Template, 2, 0, \"ng-template\", null, 14, i0.ɵɵtemplateRefExtractor);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            const _r2 = i0.ɵɵreference(22);\n            i0.ɵɵadvance(10);\n            i0.ɵɵproperty(\"disabled\", ctx.loading);\n            i0.ɵɵadvance(1);\n            i0.ɵɵtextInterpolate1(\" \", ctx.loading ? \"Refreshing\\u2026\" : \"Refresh\", \" \");\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.requests == null ? null : ctx.requests.length)(\"ngIfElse\", _r2);\n          }\n        },\n        dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i2.DatePipe],\n        styles: [\"[_nghost-%COMP%]{display:block}\"]\n      });\n    }\n  }\n  return RoleAdminComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}