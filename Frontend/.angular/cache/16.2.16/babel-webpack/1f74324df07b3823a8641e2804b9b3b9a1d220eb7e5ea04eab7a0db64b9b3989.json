{"ast":null,"code":"import { UserRole } from '../../shared/models/user.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../modules/nsb-management/services/nsb.service\";\nimport * as i2 from \"../../modules/auth/services/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction StakeholderRegistryListComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.error, \" \");\n  }\n}\nfunction StakeholderRegistryListComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"p\", 16);\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction StakeholderRegistryListComponent_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"p\", 16);\n    i0.ɵɵtext(2, \"No stakeholder registries found.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction StakeholderRegistryListComponent_div_20_tr_15_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const nsb_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(nsb_r5.shortName);\n  }\n}\nfunction StakeholderRegistryListComponent_div_20_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 23)(1, \"td\", 24)(2, \"div\", 25);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, StakeholderRegistryListComponent_div_20_tr_15_div_4_Template, 2, 1, \"div\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 24)(6, \"div\", 27);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\", 24)(9, \"span\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"td\", 28);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\", 29)(14, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function StakeholderRegistryListComponent_div_20_tr_15_Template_button_click_14_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const nsb_r5 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.viewRegistry(nsb_r5));\n    });\n    i0.ɵɵtext(15, \" View \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const nsb_r5 = ctx.$implicit;\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(nsb_r5.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", nsb_r5.shortName);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate((nsb_r5.country == null ? null : nsb_r5.country.name) || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMapInterpolate1(\"px-2 py-1 text-xs font-semibold rounded-full \", ctx_r4.getStatusBadgeClass(nsb_r5.stakeholderRegistryStatus), \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.getStatusLabel(nsb_r5.stakeholderRegistryStatus), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r4.formatDate(nsb_r5.stakeholderRegistrySubmittedAt), \" \");\n  }\n}\nfunction StakeholderRegistryListComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"table\", 18)(2, \"thead\", 19)(3, \"tr\")(4, \"th\", 20);\n    i0.ɵɵtext(5, \"NSB Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\", 20);\n    i0.ɵɵtext(7, \"Country\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\", 20);\n    i0.ɵɵtext(9, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 20);\n    i0.ɵɵtext(11, \"Submitted At\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\", 20);\n    i0.ɵɵtext(13, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(14, \"tbody\", 21);\n    i0.ɵɵtemplate(15, StakeholderRegistryListComponent_div_20_tr_15_Template, 16, 8, \"tr\", 22);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(15);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.filteredNsbs);\n  }\n}\nexport let StakeholderRegistryListComponent = /*#__PURE__*/(() => {\n  class StakeholderRegistryListComponent {\n    constructor(nsbService, authService, router) {\n      this.nsbService = nsbService;\n      this.authService = authService;\n      this.router = router;\n      this.nsbs = [];\n      this.loading = false;\n      this.error = '';\n      this.filterStatus = 'ALL';\n    }\n    ngOnInit() {\n      this.loadRegistries();\n    }\n    loadRegistries() {\n      this.loading = true;\n      this.error = '';\n      const user = this.authService.currentUserValue;\n      const userRoles = user?.roles || (user?.role ? [user.role] : []);\n      const isSuperAdmin = userRoles.includes(UserRole.SUPER_ADMIN) || userRoles.includes(UserRole.ARSO_SECRETARIAT);\n      if (isSuperAdmin) {\n        // Super admins can see all NSBs\n        this.nsbService.getNsbList({\n          limit: 1000\n        }).subscribe({\n          next: response => {\n            this.nsbs = response.data || [];\n            this.loading = false;\n          },\n          error: () => {\n            this.error = 'Failed to load stakeholder registries.';\n            this.loading = false;\n          }\n        });\n      } else if (userRoles.includes(UserRole.NSB_ADMIN)) {\n        // NSB admins can only see their own NSB\n        this.nsbService.getMyNsb().subscribe({\n          next: nsb => {\n            this.nsbs = nsb ? [nsb] : [];\n            this.loading = false;\n          },\n          error: () => {\n            this.error = 'Failed to load your stakeholder registry.';\n            this.loading = false;\n          }\n        });\n      } else {\n        this.error = 'You do not have permission to view stakeholder registries.';\n        this.loading = false;\n      }\n    }\n    get filteredNsbs() {\n      if (this.filterStatus === 'ALL') {\n        return this.nsbs;\n      }\n      return this.nsbs.filter(nsb => nsb.stakeholderRegistryStatus === this.filterStatus);\n    }\n    getStatusBadgeClass(status) {\n      switch (status) {\n        case 'SUBMITTED':\n          return 'bg-emerald-100 text-emerald-800';\n        case 'DRAFT':\n          return 'bg-yellow-100 text-yellow-800';\n        default:\n          return 'bg-slate-100 text-slate-800';\n      }\n    }\n    getStatusLabel(status) {\n      switch (status) {\n        case 'SUBMITTED':\n          return 'Submitted';\n        case 'DRAFT':\n          return 'Draft';\n        default:\n          return 'Not Started';\n      }\n    }\n    viewRegistry(nsb) {\n      // For now, navigate to the form - super admins will see the first NSB's registry\n      // In a full implementation, we'd pass the nsbId as a query param\n      this.router.navigate(['/nsb/stakeholder-registry']);\n    }\n    formatDate(dateString) {\n      if (!dateString) return '-';\n      const date = new Date(dateString);\n      return date.toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric'\n      });\n    }\n    static {\n      this.ɵfac = function StakeholderRegistryListComponent_Factory(t) {\n        return new (t || StakeholderRegistryListComponent)(i0.ɵɵdirectiveInject(i1.NsbService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: StakeholderRegistryListComponent,\n        selectors: [[\"app-stakeholder-registry-list\"]],\n        decls: 21,\n        vars: 5,\n        consts: [[1, \"w-full\", \"max-w-7xl\", \"mx-auto\"], [1, \"bg-white\", \"rounded-xl\", \"shadow-sm\", \"border\", \"border-slate-200\", \"overflow-hidden\"], [1, \"px-8\", \"py-6\", \"border-b\", \"border-slate-100\", \"bg-slate-50/50\"], [1, \"flex\", \"items-center\", \"justify-between\"], [1, \"text-2xl\", \"font-bold\", \"text-slate-900\"], [1, \"mt-1\", \"text-sm\", \"text-slate-500\"], [1, \"flex\", \"gap-3\"], [1, \"px-4\", \"py-2\", \"text-sm\", \"border\", \"border-slate-300\", \"rounded-lg\", \"focus:outline-none\", \"focus:ring-2\", \"focus:ring-blue-500\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"ALL\"], [\"value\", \"DRAFT\"], [\"value\", \"SUBMITTED\"], [\"class\", \"mx-8 mt-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800\", 4, \"ngIf\"], [\"class\", \"text-center py-12\", 4, \"ngIf\"], [\"class\", \"overflow-x-auto\", 4, \"ngIf\"], [1, \"mx-8\", \"mt-6\", \"p-4\", \"bg-red-50\", \"border\", \"border-red-200\", \"rounded-lg\", \"text-red-800\"], [1, \"text-center\", \"py-12\"], [1, \"text-slate-500\"], [1, \"overflow-x-auto\"], [1, \"w-full\"], [1, \"bg-slate-50\", \"border-b\", \"border-slate-200\"], [1, \"px-6\", \"py-3\", \"text-left\", \"text-xs\", \"font-semibold\", \"uppercase\", \"tracking-wider\", \"text-slate-700\"], [1, \"bg-white\", \"divide-y\", \"divide-slate-200\"], [\"class\", \"hover:bg-slate-50\", 4, \"ngFor\", \"ngForOf\"], [1, \"hover:bg-slate-50\"], [1, \"px-6\", \"py-4\", \"whitespace-nowrap\"], [1, \"text-sm\", \"font-medium\", \"text-slate-900\"], [\"class\", \"text-sm text-slate-500\", 4, \"ngIf\"], [1, \"text-sm\", \"text-slate-900\"], [1, \"px-6\", \"py-4\", \"whitespace-nowrap\", \"text-sm\", \"text-slate-500\"], [1, \"px-6\", \"py-4\", \"whitespace-nowrap\", \"text-sm\", \"font-medium\"], [1, \"text-blue-600\", \"hover:text-blue-900\", \"font-semibold\", 3, \"click\"], [1, \"text-sm\", \"text-slate-500\"]],\n        template: function StakeholderRegistryListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\")(5, \"h1\", 4);\n            i0.ɵɵtext(6, \"Stakeholder Registry Status\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"p\", 5);\n            i0.ɵɵtext(8, \"View and manage stakeholder registry submissions\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(9, \"div\", 6)(10, \"select\", 7);\n            i0.ɵɵlistener(\"ngModelChange\", function StakeholderRegistryListComponent_Template_select_ngModelChange_10_listener($event) {\n              return ctx.filterStatus = $event;\n            })(\"ngModelChange\", function StakeholderRegistryListComponent_Template_select_ngModelChange_10_listener() {\n              return ctx.loadRegistries();\n            });\n            i0.ɵɵelementStart(11, \"option\", 8);\n            i0.ɵɵtext(12, \"All Statuses\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"option\", 9);\n            i0.ɵɵtext(14, \"Draft\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"option\", 10);\n            i0.ɵɵtext(16, \"Submitted\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵtemplate(17, StakeholderRegistryListComponent_div_17_Template, 2, 1, \"div\", 11);\n            i0.ɵɵtemplate(18, StakeholderRegistryListComponent_div_18_Template, 3, 0, \"div\", 12);\n            i0.ɵɵtemplate(19, StakeholderRegistryListComponent_div_19_Template, 3, 0, \"div\", 12);\n            i0.ɵɵtemplate(20, StakeholderRegistryListComponent_div_20_Template, 16, 1, \"div\", 13);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(10);\n            i0.ɵɵproperty(\"ngModel\", ctx.filterStatus);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.filteredNsbs.length === 0);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", !ctx.loading && ctx.filteredNsbs.length > 0);\n          }\n        },\n        dependencies: [i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel],\n        styles: [\"[_nghost-%COMP%]{display:block}\"]\n      });\n    }\n  }\n  return StakeholderRegistryListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}