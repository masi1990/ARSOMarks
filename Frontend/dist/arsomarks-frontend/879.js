"use strict";(self.webpackChunkarsomarks_frontend=self.webpackChunkarsomarks_frontend||[]).push([[879],{2879:(H,p,d)=>{d.r(p),d.d(p,{MarkLicenseModificationModule:()=>J});var l=d(177),r=d(9417),u=d(1377),f=d(980),e=d(6276),g=d(1626),x=d(5312);let F=(()=>{class i{constructor(t){this.http=t,this.baseUrl=`${x.c.apiBase}/mark-licenses/modifications`}requestModification(t){return this.http.post(this.baseUrl,t)}getModificationById(t){return this.http.get(`${this.baseUrl}/${t}`)}approveModification(t,s,n){return this.http.post(`${this.baseUrl}/${t}/approve`,{implementedChanges:s,notes:n})}rejectModification(t,s){return this.http.post(`${this.baseUrl}/${t}/reject`,{rejectionReason:s})}getModificationHistory(t){const s=(new g.Nl).set("licenseId",t);return this.http.get(this.baseUrl,{params:s})}static{this.\u0275fac=function(s){return new(s||i)(e.KVO(g.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var b=d(4699);function k(i,o){if(1&i&&(e.j41(0,"p",11),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.SpI("License: ",t.agreement.agreementId,"")}}function v(i,o){if(1&i&&(e.j41(0,"div",12)(1,"span",13),e.EFF(2),e.k0s()()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngClass",t.getStatusBadgeClass(t.existingModification.status)),e.R7$(1),e.SpI(" ",t.existingModification.status," ")}}function _(i,o){if(1&i&&(e.j41(0,"div",14)(1,"p",15),e.EFF(2),e.k0s()()),2&i){const t=e.XpG();e.R7$(2),e.JRh(t.successMessage)}}function E(i,o){if(1&i&&(e.j41(0,"div",16),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.SpI(" ",t.error," ")}}function M(i,o){if(1&i&&(e.j41(0,"div",44)(1,"h3",45),e.EFF(2,"Current License Information"),e.k0s(),e.j41(3,"div",46)(4,"div")(5,"span",15),e.EFF(6,"Agreement ID:"),e.k0s(),e.EFF(7),e.k0s(),e.j41(8,"div")(9,"span",15),e.EFF(10,"License Type:"),e.k0s(),e.EFF(11),e.k0s(),e.j41(12,"div")(13,"span",15),e.EFF(14,"Start Date:"),e.k0s(),e.EFF(15),e.k0s(),e.j41(16,"div")(17,"span",15),e.EFF(18,"End Date:"),e.k0s(),e.EFF(19),e.k0s()()()),2&i){const t=e.XpG(2);e.R7$(7),e.SpI(" ",t.agreement.agreementId," "),e.R7$(4),e.SpI(" ",t.agreement.licenseTypeDisplay," "),e.R7$(4),e.SpI(" ",t.formatDate(t.agreement.licenseStartDate)," "),e.R7$(4),e.SpI(" ",t.formatDate(t.agreement.licenseEndDate)," ")}}function j(i,o){if(1&i&&(e.j41(0,"label",47),e.nrm(1,"input",48),e.j41(2,"span",49),e.EFF(3),e.k0s()()),2&i){const t=o.$implicit;e.R7$(1),e.Y8G("value",t.value),e.R7$(2),e.JRh(t.label)}}function y(i,o){1&i&&(e.j41(0,"p",50),e.EFF(1," At least one modification type must be selected "),e.k0s())}function I(i,o){if(1&i&&(e.j41(0,"option",51),e.EFF(1),e.k0s()),2&i){const t=o.$implicit;e.Y8G("value",t.value),e.R7$(1),e.JRh(t.label)}}function C(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",52)(1,"span",49),e.EFF(2),e.k0s(),e.j41(3,"button",53),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.removeJustificationFile())}),e.EFF(4,"Remove"),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(2),e.JRh(t.justificationFile.name)}}function R(i,o){if(1&i&&(e.j41(0,"div")(1,"span",15),e.EFF(2,"Reviewed At:"),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG(3);e.R7$(3),e.SpI(" ",t.formatDate(t.existingModification.reviewedAt)," ")}}function D(i,o){if(1&i&&(e.j41(0,"div",59)(1,"p",60),e.EFF(2,"Rejection Reason:"),e.k0s(),e.j41(3,"p",61),e.EFF(4),e.k0s()()),2&i){const t=e.XpG(3);e.R7$(4),e.JRh(t.existingModification.rejectionReason)}}function N(i,o){if(1&i&&(e.j41(0,"div",62)(1,"p",63),e.EFF(2,"Implemented Changes:"),e.k0s(),e.j41(3,"pre",64),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&i){const t=e.XpG(3);e.R7$(4),e.JRh(e.bMT(5,1,t.existingModification.implementedChanges))}}function w(i,o){if(1&i&&(e.j41(0,"section",18)(1,"h2",19),e.EFF(2,"Review Status"),e.k0s(),e.j41(3,"div",54)(4,"div",46)(5,"div")(6,"span",15),e.EFF(7,"Status:"),e.k0s(),e.j41(8,"span",55),e.EFF(9),e.k0s()(),e.DNE(10,R,4,1,"div",56),e.k0s(),e.DNE(11,D,5,1,"div",57),e.DNE(12,N,6,3,"div",58),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(8),e.Y8G("ngClass",t.getStatusBadgeClass(t.existingModification.status)),e.R7$(1),e.SpI(" ",t.existingModification.status," "),e.R7$(1),e.Y8G("ngIf",t.existingModification.reviewedAt),e.R7$(1),e.Y8G("ngIf",t.existingModification.rejectionReason),e.R7$(1),e.Y8G("ngIf",t.existingModification.implementedChanges)}}function T(i,o){1&i&&(e.j41(0,"span"),e.EFF(1,"Submit Modification Request"),e.k0s())}function L(i,o){1&i&&(e.j41(0,"span"),e.EFF(1,"Submitting..."),e.k0s())}function G(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",65)(1,"button",66),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.submitModification())}),e.DNE(2,T,2,0,"span",56),e.DNE(3,L,2,0,"span",56),e.k0s()()}if(2&i){const t=e.XpG(2);e.R7$(1),e.Y8G("disabled",t.submitting||t.form.invalid),e.R7$(1),e.Y8G("ngIf",!t.submitting),e.R7$(1),e.Y8G("ngIf",t.submitting)}}function S(i,o){if(1&i){const t=e.RV6();e.j41(0,"div",65)(1,"button",67),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.navigateToDashboard())}),e.EFF(2," Back to Dashboard "),e.k0s()()}}function A(i,o){if(1&i){const t=e.RV6();e.j41(0,"form",17)(1,"section",18)(2,"h2",19),e.EFF(3,"Modification Details"),e.k0s(),e.DNE(4,M,20,4,"div",20),e.j41(5,"div",21)(6,"label",22),e.EFF(7,"Type of Modification "),e.j41(8,"span",23),e.EFF(9,"*"),e.k0s()(),e.j41(10,"div",21),e.DNE(11,j,4,2,"label",24),e.k0s(),e.DNE(12,y,2,0,"p",25),e.k0s(),e.j41(13,"div",21)(14,"label",26),e.EFF(15,"Reason for Modification "),e.j41(16,"span",23),e.EFF(17,"*"),e.k0s()(),e.nrm(18,"textarea",27),e.k0s(),e.j41(19,"div",21)(20,"label",28),e.EFF(21,"Proposed Changes "),e.j41(22,"span",23),e.EFF(23,"*"),e.k0s()(),e.nrm(24,"textarea",29),e.k0s(),e.j41(25,"div",30)(26,"div",21)(27,"label",31),e.EFF(28,"Requested Effective Date "),e.j41(29,"span",23),e.EFF(30,"*"),e.k0s()(),e.nrm(31,"input",32),e.k0s(),e.j41(32,"div",21)(33,"label",33),e.EFF(34,"Fee Adjustment Needed "),e.j41(35,"span",23),e.EFF(36,"*"),e.k0s()(),e.j41(37,"select",34)(38,"option",35),e.EFF(39,"Select option"),e.k0s(),e.DNE(40,I,2,2,"option",36),e.k0s()()(),e.j41(41,"div",21)(42,"label",37),e.EFF(43,"Impact Assessment"),e.k0s(),e.nrm(44,"textarea",38),e.k0s(),e.j41(45,"div",21)(46,"label",22),e.EFF(47,"Supporting Justification Document"),e.k0s(),e.j41(48,"input",39),e.bIt("change",function(n){e.eBV(t);const a=e.XpG();return e.Njj(a.onJustificationFileSelected(n))}),e.k0s(),e.j41(49,"p",40),e.EFF(50,"Upload business case document or justification (PDF, DOC, DOCX)"),e.k0s(),e.DNE(51,C,5,1,"div",41),e.k0s()(),e.DNE(52,w,13,5,"section",42),e.DNE(53,G,4,3,"div",43),e.DNE(54,S,3,0,"div",43),e.k0s()}if(2&i){const t=e.XpG();let s;e.Y8G("formGroup",t.form),e.R7$(4),e.Y8G("ngIf",t.agreement),e.R7$(7),e.Y8G("ngForOf",t.modificationTypeOptions),e.R7$(1),e.Y8G("ngIf",(null==(s=t.form.get("modificationTypes"))?null:s.invalid)&&(null==(s=t.form.get("modificationTypes"))?null:s.touched)),e.R7$(28),e.Y8G("ngForOf",t.feeAdjustmentOptions),e.R7$(11),e.Y8G("ngIf",t.justificationFile),e.R7$(1),e.Y8G("ngIf",t.existingModification&&"PENDING"!==t.existingModification.status),e.R7$(1),e.Y8G("ngIf",!t.existingModification||"PENDING"===t.existingModification.status),e.R7$(1),e.Y8G("ngIf",t.existingModification&&"PENDING"!==t.existingModification.status)}}function $(i,o){1&i&&(e.j41(0,"div",68)(1,"p",69),e.EFF(2,"Loading..."),e.k0s()())}let h=(()=>{class i{constructor(t,s,n,a,c){this.fb=t,this.modificationService=s,this.agreementService=n,this.route=a,this.router=c,this.loading=!1,this.submitting=!1,this.error="",this.success=!1,this.successMessage="",this.licenseId=null,this.agreement=null,this.existingModification=null,this.modificationId=null,this.modificationTypeOptions=[{value:"EXTEND_DURATION",label:"Extend Duration"},{value:"CHANGE_SCOPE",label:"Change Scope"},{value:"ADD_NEW_MARKS",label:"Add New Marks"},{value:"CHANGE_MEDIA",label:"Change Media"},{value:"UPDATE_CONTACT",label:"Update Contact"},{value:"OTHER",label:"Other"}],this.feeAdjustmentOptions=[{value:"YES",label:"Yes"},{value:"NO",label:"No"},{value:"TO_BE_DETERMINED",label:"To Be Determined"}],this.justificationFile=null,this.form=this.createForm()}ngOnInit(){this.route.params.subscribe(t=>{this.licenseId=t.licenseId,this.modificationId=t.id,this.licenseId&&this.loadAgreement(),this.modificationId&&this.loadModification()})}createForm(){return this.fb.group({originalLicenseId:["",[r.k0.required]],modificationTypes:[[],[r.k0.required,this.arrayNotEmptyValidator]],modificationReason:["",[r.k0.required]],proposedChanges:["",[r.k0.required]],effectiveDateRequest:["",[r.k0.required]],supportingJustificationPath:[""],impactAssessment:[""],feeAdjustmentNeeded:["",[r.k0.required]]})}arrayNotEmptyValidator(t){return t.value&&Array.isArray(t.value)&&0!==t.value.length?null:{arrayNotEmpty:!0}}loadAgreement(){this.licenseId&&(this.loading=!0,this.agreementService.getAgreementById(this.licenseId).pipe((0,f.j)(()=>{this.loading=!1})).subscribe({next:t=>{this.agreement=t,this.form.patchValue({originalLicenseId:this.licenseId})},error:t=>{this.error=t.error?.message||"Failed to load license agreement."}}))}loadModification(){this.modificationId&&(this.loading=!0,this.modificationService.getModificationById(this.modificationId).pipe((0,f.j)(()=>{this.loading=!1})).subscribe({next:t=>{this.existingModification=t,this.licenseId=t.originalLicenseId,this.loadAgreement(),this.loadModificationData(t)},error:t=>{this.error=t.error?.message||"Failed to load modification request."}}))}loadModificationData(t){this.form.patchValue({modificationTypes:t.modificationTypes,modificationReason:t.modificationReason,proposedChanges:t.proposedChanges,effectiveDateRequest:t.effectiveDateRequest.split("T")[0],impactAssessment:t.impactAssessment,feeAdjustmentNeeded:t.feeAdjustmentNeeded})}onJustificationFileSelected(t){const s=t.target.files[0];s&&(this.justificationFile=s)}removeJustificationFile(){this.justificationFile=null}submitModification(){if(this.form.invalid)return this.markFormGroupTouched(this.form),void(this.error="Please fill in all required fields correctly.");this.submitting=!0,this.error="";const s={...this.form.getRawValue(),supportingJustificationPath:this.justificationFile?.name||void 0};this.modificationService.requestModification(s).pipe((0,f.j)(()=>{this.submitting=!1})).subscribe({next:a=>{this.existingModification=a,this.success=!0,this.successMessage="Modification request submitted successfully!",setTimeout(()=>{this.router.navigate(["/mark-licenses/dashboard"])},2e3)},error:a=>{this.error=a.error?.message||"Failed to submit modification request. Please try again."}})}markFormGroupTouched(t){Object.keys(t.controls).forEach(s=>{t.get(s)?.markAsTouched()})}getStatusBadgeClass(t){switch(t){case"APPROVED":return"bg-emerald-100 text-emerald-800";case"REJECTED":return"bg-red-100 text-red-800";case"PENDING":return"bg-amber-100 text-amber-800";case"UNDER_REVIEW":return"bg-blue-100 text-blue-800";case"IMPLEMENTED":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""}navigateToDashboard(){this.router.navigate(["/mark-licenses/dashboard"])}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(r.ok),e.rXU(F),e.rXU(b.G),e.rXU(u.nX),e.rXU(u.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-mark-license-modification"]],decls:13,vars:6,consts:[[1,"w-full","max-w-6xl","mx-auto"],[1,"bg-white","rounded-xl","shadow-sm","border","border-slate-200","overflow-hidden"],[1,"px-8","py-6","border-b","border-slate-100","bg-slate-50/50"],[1,"text-2xl","font-bold","text-slate-900"],[1,"mt-1","text-sm","font-medium","text-slate-600"],["class","mt-1 text-sm text-slate-500",4,"ngIf"],["class","mt-2",4,"ngIf"],["class","mx-8 mt-6 p-4 bg-emerald-50 border border-emerald-200 rounded-lg text-emerald-800",4,"ngIf"],["class","mx-8 mt-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800",4,"ngIf"],["class","p-8 space-y-10",3,"formGroup",4,"ngIf"],["class","p-8 text-center",4,"ngIf"],[1,"mt-1","text-sm","text-slate-500"],[1,"mt-2"],[1,"px-3","py-1","rounded-full","text-sm","font-semibold",3,"ngClass"],[1,"mx-8","mt-6","p-4","bg-emerald-50","border","border-emerald-200","rounded-lg","text-emerald-800"],[1,"font-semibold"],[1,"mx-8","mt-6","p-4","bg-red-50","border","border-red-200","rounded-lg","text-red-800"],[1,"p-8","space-y-10",3,"formGroup"],[1,"space-y-6"],[1,"text-lg","font-bold","text-slate-900","border-b","border-slate-200","pb-3"],["class","p-4 bg-blue-50 rounded-lg border border-blue-200",4,"ngIf"],[1,"space-y-2"],[1,"block","text-sm","font-semibold","text-slate-700"],[1,"text-red-500"],["class","flex items-center space-x-2 cursor-pointer",4,"ngFor","ngForOf"],["class","text-xs text-red-500 mt-1",4,"ngIf"],["for","modificationReason",1,"block","text-sm","font-semibold","text-slate-700"],["id","modificationReason","formControlName","modificationReason","rows","4","placeholder","Explain why this modification is needed",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["for","proposedChanges",1,"block","text-sm","font-semibold","text-slate-700"],["id","proposedChanges","formControlName","proposedChanges","rows","6","placeholder","Describe in detail what changes you are requesting",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],[1,"grid","gap-6","md:grid-cols-2"],["for","effectiveDateRequest",1,"block","text-sm","font-semibold","text-slate-700"],["type","date","id","effectiveDateRequest","formControlName","effectiveDateRequest",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["for","feeAdjustmentNeeded",1,"block","text-sm","font-semibold","text-slate-700"],["id","feeAdjustmentNeeded","formControlName","feeAdjustmentNeeded",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","impactAssessment",1,"block","text-sm","font-semibold","text-slate-700"],["id","impactAssessment","formControlName","impactAssessment","rows","4","placeholder","How will these changes affect your usage of the marks?",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["type","file","accept",".pdf,.doc,.docx",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm",3,"change"],[1,"text-xs","text-slate-500","mt-1"],["class","mt-2 flex items-center justify-between p-2 bg-slate-50 rounded",4,"ngIf"],["class","space-y-6",4,"ngIf"],["class","flex gap-4 justify-end pt-6 border-t border-slate-200",4,"ngIf"],[1,"p-4","bg-blue-50","rounded-lg","border","border-blue-200"],[1,"font-semibold","text-slate-900","mb-2"],[1,"grid","gap-4","md:grid-cols-2","text-sm"],[1,"flex","items-center","space-x-2","cursor-pointer"],["type","checkbox","formControlName","modificationTypes",1,"rounded","border-slate-300","text-blue-600","focus:ring-blue-600",3,"value"],[1,"text-sm","text-slate-700"],[1,"text-xs","text-red-500","mt-1"],[3,"value"],[1,"mt-2","flex","items-center","justify-between","p-2","bg-slate-50","rounded"],["type","button",1,"text-red-600","hover:text-red-800","text-sm",3,"click"],[1,"p-4","bg-slate-50","rounded-lg","border","border-slate-200","space-y-3"],[1,"ml-2","px-2","py-1","rounded","text-xs","font-semibold",3,"ngClass"],[4,"ngIf"],["class","p-3 bg-red-50 rounded border border-red-200",4,"ngIf"],["class","p-3 bg-green-50 rounded border border-green-200",4,"ngIf"],[1,"p-3","bg-red-50","rounded","border","border-red-200"],[1,"font-semibold","text-red-800","text-sm","mb-1"],[1,"text-sm","text-red-700"],[1,"p-3","bg-green-50","rounded","border","border-green-200"],[1,"font-semibold","text-green-800","text-sm","mb-1"],[1,"text-sm","text-green-700","whitespace-pre-wrap"],[1,"flex","gap-4","justify-end","pt-6","border-t","border-slate-200"],["type","button",1,"px-6","py-2.5","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"disabled","click"],["type","button",1,"px-6","py-2.5","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],[1,"p-8","text-center"],[1,"text-slate-600"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"License Modification Request"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Form NSB-004-4: Request to Modify Existing ARSO Mark License"),e.k0s(),e.DNE(7,k,2,1,"p",5),e.DNE(8,v,3,2,"div",6),e.k0s(),e.DNE(9,_,3,1,"div",7),e.DNE(10,E,2,1,"div",8),e.DNE(11,A,55,9,"form",9),e.DNE(12,$,3,0,"div",10),e.k0s()()),2&s&&(e.R7$(7),e.Y8G("ngIf",n.agreement),e.R7$(1),e.Y8G("ngIf",n.existingModification),e.R7$(1),e.Y8G("ngIf",n.success),e.R7$(1),e.Y8G("ngIf",n.error),e.R7$(1),e.Y8G("ngIf",!n.loading),e.R7$(1),e.Y8G("ngIf",n.loading))},dependencies:[l.YU,l.Sq,l.bT,r.qT,r.xH,r.y7,r.me,r.Zm,r.wz,r.BC,r.cb,r.j4,r.JD,l.TG],styles:["[_nghost-%COMP%]{display:block;width:100%}.status-badge[_ngcontent-%COMP%]{transition:all .2s ease}.modification-details[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#f8fafc,#ffffff)}.file-upload-area[_ngcontent-%COMP%]{border:2px dashed #cbd5e1;border-radius:.5rem;padding:1.5rem;text-align:center;transition:all .2s ease}.file-upload-area[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background-color:#eff6ff}.review-status[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}"]})}}return i})();var m=d(2193),Y=d(4183);function O(i,o){if(1&i&&(e.j41(0,"div",25),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.SpI(" ",t.error," ")}}function X(i,o){1&i&&(e.j41(0,"div",26),e.nrm(1,"div",27),e.j41(2,"p",28),e.EFF(3,"Loading licenses..."),e.k0s()())}function B(i,o){1&i&&(e.j41(0,"div",35)(1,"div",36),e.qSk(),e.j41(2,"svg",37),e.nrm(3,"path",38),e.k0s()(),e.joV(),e.j41(4,"p",39),e.EFF(5,"No licenses found"),e.k0s(),e.j41(6,"p",40),e.EFF(7,"You don't have any license agreements yet."),e.k0s()())}function U(i,o){if(1&i){const t=e.RV6();e.j41(0,"tr",46)(1,"td",47)(2,"button",48),e.bIt("click",function(){const a=e.eBV(t).$implicit,c=e.XpG(3);return e.Njj(c.viewAgreement(a.id))}),e.EFF(3),e.k0s()(),e.j41(4,"td",49),e.EFF(5),e.k0s(),e.j41(6,"td",47)(7,"span",50),e.EFF(8),e.k0s()(),e.j41(9,"td",49),e.EFF(10),e.k0s(),e.j41(11,"td",49),e.EFF(12),e.k0s(),e.j41(13,"td",51),e.EFF(14),e.k0s(),e.j41(15,"td",47)(16,"button",52),e.bIt("click",function(){const a=e.eBV(t).$implicit,c=e.XpG(3);return e.Njj(c.requestModification(a.id))}),e.qSk(),e.j41(17,"svg",53),e.nrm(18,"path",54),e.k0s(),e.EFF(19," Modify "),e.k0s()()()}if(2&i){const t=o.$implicit,s=e.XpG(3);e.R7$(3),e.SpI(" ",t.agreementId," "),e.R7$(2),e.JRh(t.licenseTypeDisplay),e.R7$(2),e.Y8G("ngClass",s.getStatusBadgeClass(t.agreementStatus)),e.R7$(1),e.SpI(" ",t.agreementStatus," "),e.R7$(2),e.JRh(s.formatDate(t.licenseStartDate)),e.R7$(2),e.JRh(s.formatDate(t.licenseEndDate)),e.R7$(1),e.Y8G("ngClass",s.getUrgencyClass(s.getDaysUntilExpiry(t.licenseEndDate))),e.R7$(1),e.SpI(" ",s.getDaysUntilExpiry(t.licenseEndDate)," days ")}}function P(i,o){if(1&i&&(e.j41(0,"div",41)(1,"table",42)(2,"thead")(3,"tr",43)(4,"th",44),e.EFF(5,"Agreement ID"),e.k0s(),e.j41(6,"th",44),e.EFF(7,"License Type"),e.k0s(),e.j41(8,"th",44),e.EFF(9,"Status"),e.k0s(),e.j41(10,"th",44),e.EFF(11,"Start Date"),e.k0s(),e.j41(12,"th",44),e.EFF(13,"End Date"),e.k0s(),e.j41(14,"th",44),e.EFF(15,"Days Remaining"),e.k0s(),e.j41(16,"th",44),e.EFF(17,"Actions"),e.k0s()()(),e.j41(18,"tbody"),e.DNE(19,U,20,8,"tr",45),e.k0s()()()),2&i){const t=e.XpG(2);e.R7$(19),e.Y8G("ngForOf",t.filteredAgreements)}}function V(i,o){if(1&i&&(e.j41(0,"div",29)(1,"div",30)(2,"h2",31),e.EFF(3,"All Licenses"),e.k0s(),e.j41(4,"p",32),e.EFF(5,"Select a license to request modifications"),e.k0s()(),e.DNE(6,B,8,0,"div",33),e.DNE(7,P,20,1,"div",34),e.k0s()),2&i){const t=e.XpG();e.R7$(6),e.Y8G("ngIf",0===t.filteredAgreements.length),e.R7$(1),e.Y8G("ngIf",t.filteredAgreements.length>0)}}const q=[{path:"",component:(()=>{class i{constructor(t,s,n){this.agreementService=t,this.nsbService=s,this.router=n,this.loading=!1,this.error="",this.agreements=[],this.nsb=null,this.nsbId=null,this.statusFilter="ALL"}ngOnInit(){this.loadNsb()}loadNsb(){this.loading=!0,this.nsbService.getMyNsb().pipe((0,f.j)(()=>{this.loading=!1})).subscribe({next:t=>{t?(this.nsb=t,this.nsbId=t.id,this.loadAgreements()):this.error="NSB information not found. Please ensure you have an NSB profile."},error:()=>{this.error="Failed to load NSB information. Please ensure you have an NSB profile."}})}loadAgreements(){this.nsbId&&(this.loading=!0,this.error="",this.agreementService.getActiveAgreementsByNsb(this.nsbId).pipe((0,f.j)(()=>{this.loading=!1})).subscribe({next:t=>{this.agreements=t||[]},error:t=>{this.error=t.error?.message||"Failed to load license agreements.",this.agreements=[]}}))}get filteredAgreements(){return"ALL"===this.statusFilter?this.agreements:this.agreements.filter(t=>t.agreementStatus===this.statusFilter)}requestModification(t){this.router.navigate(["/mark-licenses/modifications/new",t])}viewAgreement(t){this.router.navigate(["/mark-licenses/agreements",t])}getStatusBadgeClass(t){switch(t){case m.hs.EXECUTED:case"ACTIVE":return"bg-emerald-100 text-emerald-800";case m.hs.PENDING_NSB:case m.hs.PENDING_ARSO:return"bg-amber-100 text-amber-800";case m.hs.DRAFT:return"bg-slate-100 text-slate-800";default:return"bg-gray-100 text-gray-800"}}formatDate(t){return t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""}getDaysUntilExpiry(t){if(!t)return 0;const s=new Date(t),n=new Date,a=s.getTime()-n.getTime();return Math.ceil(a/864e5)}getUrgencyClass(t){return t<0?"text-red-600 font-semibold":t<=30?"text-amber-600 font-semibold":"text-slate-600"}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(b.G),e.rXU(Y.B),e.rXU(u.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-mark-license-modification-list"]],decls:48,vars:4,consts:[[1,"w-full","max-w-7xl","mx-auto"],[1,"mb-6"],[1,"text-3xl","font-bold","text-slate-900"],[1,"mt-1","text-sm","text-slate-600"],["class","mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800",4,"ngIf"],[1,"mb-6","bg-white","rounded-lg","shadow-sm","border","border-slate-200","p-4"],[1,"flex","items-center","gap-4"],[1,"text-sm","font-semibold","text-slate-700"],[1,"px-3","py-2","border","border-slate-300","rounded-lg","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none",3,"ngModel","ngModelChange","change"],["value","ALL"],["value","EXECUTED"],["value","PENDING_NSB"],["value","PENDING_ARSO"],["value","DRAFT"],["value","ARCHIVED"],["class","bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",4,"ngIf"],["class","bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",4,"ngIf"],[1,"mt-6","bg-blue-50","border","border-blue-200","rounded-lg","p-4"],[1,"flex","items-start","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-blue-600","mt-0.5","shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex-1"],[1,"text-sm","font-semibold","text-blue-900","mb-1"],[1,"text-sm","text-blue-800"],[1,"mt-2","text-sm","text-blue-800","list-disc","list-inside","space-y-1"],[1,"mb-6","p-4","bg-red-50","border","border-red-200","rounded-lg","text-red-800"],[1,"bg-white","rounded-xl","shadow-sm","border","border-slate-200","p-12","text-center"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-600"],[1,"mt-4","text-sm","text-slate-600"],[1,"bg-white","rounded-xl","shadow-sm","border","border-slate-200","overflow-hidden"],[1,"px-6","py-4","border-b","border-slate-200","bg-slate-50"],[1,"text-lg","font-bold","text-slate-900"],[1,"text-sm","text-slate-600","mt-1"],["class","p-12 text-center",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],[1,"p-12","text-center"],[1,"rounded-full","bg-slate-100","p-4","mb-3","inline-block"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-8","w-8","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"text-sm","font-medium","text-slate-700"],[1,"mt-1","text-xs","text-slate-500"],[1,"overflow-x-auto"],[1,"w-full"],[1,"border-b","border-slate-200","bg-slate-50"],[1,"text-left","py-4","px-6","text-sm","font-semibold","text-slate-700"],["class","border-b border-slate-100 hover:bg-slate-50 transition-colors",4,"ngFor","ngForOf"],[1,"border-b","border-slate-100","hover:bg-slate-50","transition-colors"],[1,"py-4","px-6"],[1,"text-blue-600","hover:text-blue-800","font-medium","text-sm",3,"click"],[1,"py-4","px-6","text-sm","text-slate-700"],[1,"px-2.5","py-1","rounded-full","text-xs","font-semibold",3,"ngClass"],[1,"py-4","px-6","text-sm",3,"ngClass"],[1,"inline-flex","items-center","gap-2","px-4","py-2","bg-blue-600","text-white","text-sm","font-semibold","rounded-lg","hover:bg-blue-700","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3,"License Modifications"),e.k0s(),e.j41(4,"p",3),e.EFF(5,"Request modifications to your existing ARSO Mark Licenses"),e.k0s()(),e.DNE(6,O,2,1,"div",4),e.j41(7,"div",5)(8,"div",6)(9,"label",7),e.EFF(10,"Filter by Status:"),e.k0s(),e.j41(11,"select",8),e.bIt("ngModelChange",function(c){return n.statusFilter=c})("change",function(){return n.loadAgreements()}),e.j41(12,"option",9),e.EFF(13,"All Statuses"),e.k0s(),e.j41(14,"option",10),e.EFF(15,"Executed"),e.k0s(),e.j41(16,"option",11),e.EFF(17,"Pending NSB Signature"),e.k0s(),e.j41(18,"option",12),e.EFF(19,"Pending ARSO Signature"),e.k0s(),e.j41(20,"option",13),e.EFF(21,"Draft"),e.k0s(),e.j41(22,"option",14),e.EFF(23,"Archived"),e.k0s()()()(),e.DNE(24,X,4,0,"div",15),e.DNE(25,V,8,2,"div",16),e.j41(26,"div",17)(27,"div",18),e.qSk(),e.j41(28,"svg",19),e.nrm(29,"path",20),e.k0s(),e.joV(),e.j41(30,"div",21)(31,"h3",22),e.EFF(32,"About License Modifications"),e.k0s(),e.j41(33,"p",23),e.EFF(34," You can request modifications to your existing licenses, including: "),e.k0s(),e.j41(35,"ul",24)(36,"li"),e.EFF(37,"Extending the license duration"),e.k0s(),e.j41(38,"li"),e.EFF(39,"Changing the license scope"),e.k0s(),e.j41(40,"li"),e.EFF(41,"Adding new marks"),e.k0s(),e.j41(42,"li"),e.EFF(43,"Changing media"),e.k0s(),e.j41(44,"li"),e.EFF(45,"Updating contact information"),e.k0s(),e.j41(46,"li"),e.EFF(47,"Other modifications"),e.k0s()()()()()()),2&s&&(e.R7$(6),e.Y8G("ngIf",n.error),e.R7$(5),e.Y8G("ngModel",n.statusFilter),e.R7$(13),e.Y8G("ngIf",n.loading),e.R7$(1),e.Y8G("ngIf",!n.loading))},dependencies:[l.YU,l.Sq,l.bT,r.xH,r.y7,r.wz,r.BC,r.vS],styles:["[_nghost-%COMP%]{display:block}"]})}}return i})()},{path:"new/:licenseId",component:h},{path:":id",component:h}];let J=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[l.MD,r.X1,r.YN,u.iI.forChild(q)]})}}return i})()}}]);