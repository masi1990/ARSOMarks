"use strict";(self.webpackChunkarsomarks_frontend=self.webpackChunkarsomarks_frontend||[]).push([[959],{2959:(q,f,d)=>{d.r(f),d.d(f,{MarkUsageReportModule:()=>B});var m=d(177),n=d(9417),u=d(1377),p=d(980),c=d(2193),e=d(6276),_=d(2143),k=d(4699);function h(r,i){if(1&r&&(e.j41(0,"p",10),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(1),e.SpI("License: ",t.agreement.agreementId,"")}}function v(r,i){if(1&r&&(e.j41(0,"div",11)(1,"p",12),e.EFF(2),e.k0s()()),2&r){const t=e.XpG();e.R7$(2),e.JRh(t.successMessage)}}function F(r,i){if(1&r&&(e.j41(0,"div",13),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(1),e.SpI(" ",t.error," ")}}function x(r,i){if(1&r&&(e.j41(0,"option",81),e.EFF(1),e.k0s()),2&r){const t=i.$implicit;e.Y8G("value",t.value),e.R7$(1),e.JRh(t.label)}}function C(r,i){if(1&r&&(e.j41(0,"option",81),e.EFF(1),e.k0s()),2&r){const t=i.$implicit;e.Y8G("value",t.value),e.R7$(1),e.JRh(t.label)}}function E(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",68)(1,"div",29)(2,"h4",69),e.EFF(3),e.k0s(),e.j41(4,"button",70),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(2);return e.Njj(l.removePromotionalUsage(a))}),e.EFF(5,"Remove"),e.k0s()(),e.j41(6,"div",18)(7,"label",30),e.EFF(8,"Campaign/Initiative Name "),e.j41(9,"span",20),e.EFF(10,"*"),e.k0s()(),e.nrm(11,"input",71),e.k0s(),e.j41(12,"div",37)(13,"div",18)(14,"label",30),e.EFF(15,"Media Type "),e.j41(16,"span",20),e.EFF(17,"*"),e.k0s()(),e.j41(18,"select",72)(19,"option",60),e.EFF(20,"Select media type"),e.k0s(),e.DNE(21,x,2,2,"option",61),e.k0s()(),e.j41(22,"div",18)(23,"label",30),e.EFF(24,"Mark Used "),e.j41(25,"span",20),e.EFF(26,"*"),e.k0s()(),e.j41(27,"select",73)(28,"option",60),e.EFF(29,"Select mark"),e.k0s(),e.DNE(30,C,2,2,"option",61),e.k0s()()(),e.j41(31,"div",37)(32,"div",18)(33,"label",30),e.EFF(34,"Usage Period Start "),e.j41(35,"span",20),e.EFF(36,"*"),e.k0s()(),e.nrm(37,"input",74),e.k0s(),e.j41(38,"div",18)(39,"label",30),e.EFF(40,"Usage Period End "),e.j41(41,"span",20),e.EFF(42,"*"),e.k0s()(),e.nrm(43,"input",75),e.k0s()(),e.j41(44,"div",76)(45,"div",18)(46,"label",30),e.EFF(47,"Audience Reached"),e.k0s(),e.nrm(48,"input",77),e.k0s(),e.j41(49,"div",18)(50,"label",30),e.EFF(51,"Estimated Impressions"),e.k0s(),e.nrm(52,"input",78),e.k0s(),e.j41(53,"div",18)(54,"label",30),e.EFF(55,"Actual Cost"),e.k0s(),e.nrm(56,"input",79),e.k0s()(),e.j41(57,"div",18)(58,"label",30),e.EFF(59,"Engagement Metrics"),e.k0s(),e.nrm(60,"textarea",80),e.k0s()()}if(2&r){const t=i.index,s=e.XpG(2);e.Y8G("formGroupName",t),e.R7$(3),e.SpI("Campaign ",t+1,""),e.R7$(18),e.Y8G("ngForOf",s.mediaTypeOptions),e.R7$(9),e.Y8G("ngForOf",s.markTypeOptions)}}function y(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",82)(1,"div",29)(2,"h4",69),e.EFF(3),e.k0s(),e.j41(4,"button",70),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(2);return e.Njj(l.removeCertificationUsage(a))}),e.EFF(5,"Remove"),e.k0s()(),e.j41(6,"div",18)(7,"label",30),e.EFF(8,"Sector "),e.j41(9,"span",20),e.EFF(10,"*"),e.k0s()(),e.nrm(11,"input",83),e.k0s(),e.j41(12,"div",37)(13,"div",18)(14,"label",30),e.EFF(15,"Certifications Issued "),e.j41(16,"span",20),e.EFF(17,"*"),e.k0s()(),e.nrm(18,"input",84),e.k0s(),e.j41(19,"div",18)(20,"label",30),e.EFF(21,"Mark Appearances on Products "),e.j41(22,"span",20),e.EFF(23,"*"),e.k0s()(),e.nrm(24,"input",85),e.k0s()(),e.j41(25,"div",18)(26,"label",30),e.EFF(27,"Client Feedback Summary"),e.k0s(),e.nrm(28,"textarea",86),e.k0s(),e.j41(29,"div",37)(30,"div",18)(31,"label",30),e.EFF(32,"Non-conformities Related to Mark "),e.j41(33,"span",20),e.EFF(34,"*"),e.k0s()(),e.nrm(35,"input",87),e.k0s(),e.j41(36,"div",18)(37,"label",30),e.EFF(38,"Corrective Actions Taken"),e.k0s(),e.nrm(39,"textarea",88),e.k0s()()()}if(2&r){const t=i.index;e.Y8G("formGroupName",t),e.R7$(3),e.SpI("Sector ",t+1,"")}}function R(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",89),e.nrm(1,"textarea",90),e.j41(2,"button",91),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(2);return e.Njj(l.removeSuccessStory(a))}),e.EFF(3,"Remove"),e.k0s()()}if(2&r){const t=i.index;e.R7$(1),e.Y8G("formControlName",t)}}function j(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",89),e.nrm(1,"textarea",90),e.j41(2,"button",91),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(2);return e.Njj(l.removeChallenge(a))}),e.EFF(3,"Remove"),e.k0s()()}if(2&r){const t=i.index;e.R7$(1),e.Y8G("formControlName",t)}}function N(r,i){if(1&r&&(e.j41(0,"option",81),e.EFF(1),e.k0s()),2&r){const t=i.$implicit;e.Y8G("value",t.value),e.R7$(1),e.JRh(t.label)}}function I(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",89)(1,"select",92)(2,"option",81),e.EFF(3),e.k0s()(),e.j41(4,"input",93),e.bIt("change",function(o){const l=e.eBV(t).$implicit,g=e.XpG(2);return e.Njj(g.onSupportingEvidenceSelected(o,l.value))}),e.k0s()()}if(2&r){const t=i.$implicit;e.R7$(2),e.Y8G("value",t.value),e.R7$(1),e.JRh(t.label)}}function M(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",96)(1,"span",48),e.EFF(2),e.k0s(),e.j41(3,"button",70),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(3);return e.Njj(l.removeSupportingEvidence(a))}),e.EFF(4,"Remove"),e.k0s()()}if(2&r){const t=i.$implicit;e.R7$(2),e.Lme("",t.file.name," (",t.type,")")}}function U(r,i){if(1&r&&(e.j41(0,"div",94),e.DNE(1,M,5,2,"div",95),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.supportingEvidenceFiles)}}function T(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",89)(1,"select",92)(2,"option",81),e.EFF(3),e.k0s()(),e.j41(4,"input",93),e.bIt("change",function(o){const l=e.eBV(t).$implicit,g=e.XpG(2);return e.Njj(g.onSampleSelected(o,l.value))}),e.k0s()()}if(2&r){const t=i.$implicit;e.R7$(2),e.Y8G("value",t.value),e.R7$(1),e.JRh(t.label)}}function w(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",96)(1,"span",48),e.EFF(2),e.k0s(),e.j41(3,"button",70),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(3);return e.Njj(l.removeSample(a))}),e.EFF(4,"Remove"),e.k0s()()}if(2&r){const t=i.$implicit;e.R7$(2),e.Lme("",t.file.name," (",t.type,")")}}function S(r,i){if(1&r&&(e.j41(0,"div",94),e.DNE(1,w,5,2,"div",95),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.sampleFiles)}}function A(r,i){if(1&r){const t=e.RV6();e.j41(0,"div",96)(1,"span",48),e.EFF(2),e.k0s(),e.j41(3,"button",70),e.bIt("click",function(){const a=e.eBV(t).index,l=e.XpG(3);return e.Njj(l.removeTestimonial(a))}),e.EFF(4,"Remove"),e.k0s()()}if(2&r){const t=i.$implicit;e.R7$(2),e.JRh(t.name)}}function G(r,i){if(1&r&&(e.j41(0,"div",94),e.DNE(1,A,5,1,"div",95),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.testimonialFiles)}}function O(r,i){1&r&&(e.j41(0,"span"),e.EFF(1,"Save as Draft"),e.k0s())}function P(r,i){1&r&&(e.j41(0,"span"),e.EFF(1,"Saving..."),e.k0s())}function D(r,i){1&r&&(e.j41(0,"span"),e.EFF(1,"Submit Report"),e.k0s())}function $(r,i){1&r&&(e.j41(0,"span"),e.EFF(1,"Submitting..."),e.k0s())}function Y(r,i){if(1&r){const t=e.RV6();e.j41(0,"form",14)(1,"section",15)(2,"h2",16),e.EFF(3,"Section A: Usage Summary"),e.k0s(),e.j41(4,"div",17)(5,"div",18)(6,"label",19),e.EFF(7,"Reporting Period Start "),e.j41(8,"span",20),e.EFF(9,"*"),e.k0s()(),e.nrm(10,"input",21),e.k0s(),e.j41(11,"div",18)(12,"label",22),e.EFF(13,"Reporting Period End "),e.j41(14,"span",20),e.EFF(15,"*"),e.k0s()(),e.nrm(16,"input",23),e.k0s(),e.j41(17,"div",18)(18,"label",24),e.EFF(19,"Reporting Contact Name "),e.j41(20,"span",20),e.EFF(21,"*"),e.k0s()(),e.nrm(22,"input",25),e.k0s(),e.j41(23,"div",18)(24,"label",26),e.EFF(25,"Reporting Contact Email "),e.j41(26,"span",20),e.EFF(27,"*"),e.k0s()(),e.nrm(28,"input",27),e.k0s()()(),e.j41(29,"section",15)(30,"h2",16),e.EFF(31,"Section B: Usage Metrics"),e.k0s(),e.j41(32,"div",28)(33,"div",29)(34,"label",30),e.EFF(35,"Promotional Usage Metrics"),e.k0s(),e.j41(36,"button",31),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addPromotionalUsage())}),e.EFF(37,"Add Campaign"),e.k0s()(),e.j41(38,"div",32),e.DNE(39,E,61,4,"div",33),e.k0s()(),e.j41(40,"div",28)(41,"div",29)(42,"label",30),e.EFF(43,"Certification Usage Metrics"),e.k0s(),e.j41(44,"button",31),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addCertificationUsage())}),e.EFF(45,"Add Sector"),e.k0s()(),e.j41(46,"div",34),e.DNE(47,y,40,2,"div",35),e.k0s()()(),e.j41(48,"section",36)(49,"h2",16),e.EFF(50,"Section C: Impact Assessment"),e.k0s(),e.j41(51,"div",37)(52,"div",18)(53,"label",30),e.EFF(54,"Awareness Increase Estimate"),e.k0s(),e.nrm(55,"input",38),e.k0s(),e.j41(56,"div",18)(57,"label",30),e.EFF(58,"Inquiries Received "),e.j41(59,"span",20),e.EFF(60,"*"),e.k0s()(),e.nrm(61,"input",39),e.k0s(),e.j41(62,"div",18)(63,"label",30),e.EFF(64,"Partnerships Formed"),e.k0s(),e.nrm(65,"input",40),e.k0s(),e.j41(66,"div",18)(67,"label",30),e.EFF(68,"Media Coverage Generated"),e.k0s(),e.nrm(69,"input",41),e.k0s()(),e.j41(70,"div",28)(71,"div",29)(72,"label",30),e.EFF(73,"Success Stories/Case Studies"),e.k0s(),e.j41(74,"button",31),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addSuccessStory())}),e.EFF(75,"Add Story"),e.k0s()(),e.j41(76,"div",42),e.DNE(77,R,4,1,"div",43),e.k0s()(),e.j41(78,"div",28)(79,"div",29)(80,"label",30),e.EFF(81,"Challenges Encountered"),e.k0s(),e.j41(82,"button",31),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addChallenge())}),e.EFF(83,"Add Challenge"),e.k0s()(),e.j41(84,"div",44),e.DNE(85,j,4,1,"div",43),e.k0s()()(),e.j41(86,"section",15)(87,"h2",16),e.EFF(88,"Section D: Compliance Declaration"),e.k0s(),e.j41(89,"div",45)(90,"label",46),e.nrm(91,"input",47),e.j41(92,"span",48),e.EFF(93,"Used marks only as authorized "),e.j41(94,"span",20),e.EFF(95,"*"),e.k0s()()(),e.j41(96,"label",46),e.nrm(97,"input",49),e.j41(98,"span",48),e.EFF(99,"Followed brand guidelines "),e.j41(100,"span",20),e.EFF(101,"*"),e.k0s()()(),e.j41(102,"label",46),e.nrm(103,"input",50),e.j41(104,"span",48),e.EFF(105,"Did not modify marks "),e.j41(106,"span",20),e.EFF(107,"*"),e.k0s()()(),e.j41(108,"label",46),e.nrm(109,"input",51),e.j41(110,"span",48),e.EFF(111,"Used current version of marks "),e.j41(112,"span",20),e.EFF(113,"*"),e.k0s()()()(),e.j41(114,"div",18)(115,"label",52),e.EFF(116,"Non-compliance Issues (if any)"),e.k0s(),e.nrm(117,"textarea",53),e.k0s(),e.j41(118,"div",18)(119,"label",54),e.EFF(120,"Corrective Actions Taken"),e.k0s(),e.nrm(121,"textarea",55),e.k0s(),e.j41(122,"div",18)(123,"label",56),e.EFF(124,"Planned Usage Next Year "),e.j41(125,"span",20),e.EFF(126,"*"),e.k0s()(),e.nrm(127,"textarea",57),e.k0s(),e.j41(128,"div",18)(129,"label",58),e.EFF(130,"Intention to Renew "),e.j41(131,"span",20),e.EFF(132,"*"),e.k0s()(),e.j41(133,"select",59)(134,"option",60),e.EFF(135,"Select intention"),e.k0s(),e.DNE(136,N,2,2,"option",61),e.k0s()()(),e.j41(137,"section",15)(138,"h2",16),e.EFF(139,"Supporting Evidence & Attachments"),e.k0s(),e.j41(140,"div",28)(141,"div",18)(142,"label",30),e.EFF(143,"Supporting Evidence"),e.k0s(),e.j41(144,"div",18),e.DNE(145,I,5,2,"div",43),e.k0s(),e.DNE(146,U,2,1,"div",62),e.k0s(),e.j41(147,"div",18)(148,"label",30),e.EFF(149,"Sample Materials"),e.k0s(),e.j41(150,"div",18),e.DNE(151,T,5,2,"div",43),e.k0s(),e.DNE(152,S,2,1,"div",62),e.k0s(),e.j41(153,"div",18)(154,"label",30),e.EFF(155,"Testimonial Letters"),e.k0s(),e.j41(156,"input",63),e.bIt("change",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.onTestimonialSelected(o))}),e.k0s(),e.DNE(157,G,2,1,"div",62),e.k0s()()(),e.j41(158,"div",64)(159,"button",65),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.saveDraft())}),e.DNE(160,O,2,0,"span",66),e.DNE(161,P,2,0,"span",66),e.k0s(),e.j41(162,"button",67),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.submitReport())}),e.DNE(163,D,2,0,"span",66),e.DNE(164,$,2,0,"span",66),e.k0s()()()}if(2&r){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(39),e.Y8G("ngForOf",t.promotionalUsageArray.controls),e.R7$(8),e.Y8G("ngForOf",t.certificationUsageArray.controls),e.R7$(30),e.Y8G("ngForOf",t.successStoriesArray.controls),e.R7$(8),e.Y8G("ngForOf",t.challengesArray.controls),e.R7$(51),e.Y8G("ngForOf",t.renewalIntentionOptions),e.R7$(9),e.Y8G("ngForOf",t.evidenceTypeOptions),e.R7$(1),e.Y8G("ngIf",t.supportingEvidenceFiles.length>0),e.R7$(5),e.Y8G("ngForOf",t.sampleTypeOptions),e.R7$(1),e.Y8G("ngIf",t.sampleFiles.length>0),e.R7$(5),e.Y8G("ngIf",t.testimonialFiles.length>0),e.R7$(2),e.Y8G("disabled",t.saving||t.submitting),e.R7$(1),e.Y8G("ngIf",!t.saving),e.R7$(1),e.Y8G("ngIf",t.saving),e.R7$(1),e.Y8G("disabled",t.saving||t.submitting||!t.existingReport),e.R7$(1),e.Y8G("ngIf",!t.submitting),e.R7$(1),e.Y8G("ngIf",t.submitting)}}function V(r,i){1&r&&(e.j41(0,"div",97)(1,"p",98),e.EFF(2,"Loading..."),e.k0s()())}let b=(()=>{class r{constructor(t,s,o,a,l){this.fb=t,this.reportService=s,this.agreementService=o,this.route=a,this.router=l,this.loading=!1,this.saving=!1,this.submitting=!1,this.error="",this.success=!1,this.successMessage="",this.licenseId=null,this.agreement=null,this.existingReport=null,this.reportId=null,this.mediaTypeOptions=[{value:c.zu.DIGITAL_ONLINE,label:"Digital/Online"},{value:c.zu.PRINT,label:"Print"},{value:c.zu.BROADCAST,label:"Broadcast"},{value:c.zu.OUTDOOR,label:"Outdoor"},{value:c.zu.EVENTS,label:"Events"},{value:c.zu.SOCIAL_MEDIA,label:"Social Media"},{value:c.zu.OTHER,label:"Other"}],this.markTypeOptions=[{value:c.sX.ARSO_QUALITY_MARK,label:"ARSO Quality Mark"},{value:c.sX.ECO_MARK_AFRICA,label:"Eco Mark Africa (EMA)"},{value:c.sX.BOTH,label:"Both"}],this.renewalIntentionOptions=[{value:"YES",label:"Yes"},{value:"NO",label:"No"},{value:"UNDECIDED",label:"Undecided"}],this.evidenceTypeOptions=[{value:"CAMPAIGN_PHOTOS",label:"Campaign Photos"},{value:"MEDIA_CLIPPINGS",label:"Media Clippings"},{value:"SCREENSHOTS",label:"Screenshots"},{value:"ANALYTICS_REPORTS",label:"Analytics Reports"}],this.sampleTypeOptions=[{value:"BROCHURE",label:"Brochure"},{value:"ADVERTISEMENT",label:"Advertisement"},{value:"PRODUCT_LABEL",label:"Product Label"}],this.supportingEvidenceFiles=[],this.sampleFiles=[],this.testimonialFiles=[],this.form=this.createForm()}ngOnInit(){this.route.params.subscribe(t=>{this.licenseId=t.licenseId,this.reportId=t.id,this.licenseId&&this.loadAgreement(),this.reportId&&this.loadReport()})}createForm(){return this.fb.group({licenseId:["",[n.k0.required]],reportPeriodStart:["",[n.k0.required]],reportPeriodEnd:["",[n.k0.required]],nsbContactName:["",[n.k0.required]],nsbContactEmail:["",[n.k0.required,n.k0.email]],promotionalUsageMetrics:this.fb.array([]),certificationUsageMetrics:this.fb.array([]),impactAssessment:this.fb.group({awarenessIncrease:[""],inquiriesReceived:["",[n.k0.required]],partnershipsFormed:[""],mediaCoverage:[""],successStories:this.fb.array([]),challengesFaced:this.fb.array([])}),complianceChecks:this.fb.group({usedMarksOnlyAsAuthorized:[!1,[n.k0.requiredTrue]],followedBrandGuidelines:[!1,[n.k0.requiredTrue]],didNotModifyMarks:[!1,[n.k0.requiredTrue]],usedCurrentVersionOfMarks:[!1,[n.k0.requiredTrue]]}),nonComplianceIssues:[""],correctiveActionsTaken:[""],plannedUsageNextYear:["",[n.k0.required]],renewalIntention:["",[n.k0.required]]})}loadAgreement(){this.licenseId&&(this.loading=!0,this.agreementService.getAgreementById(this.licenseId).pipe((0,p.j)(()=>{this.loading=!1})).subscribe({next:t=>{this.agreement=t,this.form.patchValue({licenseId:this.licenseId});const s=new Date,o=new Date;o.setFullYear(o.getFullYear()-1),this.form.patchValue({reportPeriodStart:o.toISOString().split("T")[0],reportPeriodEnd:s.toISOString().split("T")[0],nsbContactName:t.nsbSignerName,nsbContactEmail:t.nsbSignerEmail})},error:t=>{this.error=t.error?.message||"Failed to load license agreement."}}))}loadReport(){this.reportId&&(this.loading=!0,this.reportService.getReportById(this.reportId).pipe((0,p.j)(()=>{this.loading=!1})).subscribe({next:t=>{this.existingReport=t,this.licenseId=t.licenseId,this.loadAgreement(),this.loadReportData(t)},error:t=>{this.error=t.error?.message||"Failed to load report."}}))}loadReportData(t){this.form.patchValue({reportPeriodStart:t.reportPeriodStart.split("T")[0],reportPeriodEnd:t.reportPeriodEnd.split("T")[0],nsbContactName:t.nsbContactName,nsbContactEmail:t.nsbContactEmail,nonComplianceIssues:t.nonComplianceIssues,correctiveActionsTaken:t.correctiveActionsTaken,plannedUsageNextYear:t.plannedUsageNextYear,renewalIntention:t.renewalIntention}),t.impactAssessment&&this.form.get("impactAssessment")?.patchValue({awarenessIncrease:t.impactAssessment.awarenessIncrease,inquiriesReceived:t.impactAssessment.inquiriesReceived,partnershipsFormed:t.impactAssessment.partnershipsFormed,mediaCoverage:t.impactAssessment.mediaCoverage}),t.complianceChecks&&this.form.get("complianceChecks")?.patchValue(t.complianceChecks),t.promotionalUsageMetrics&&t.promotionalUsageMetrics.forEach(s=>{this.addPromotionalUsage(),this.promotionalUsageArray.at(this.promotionalUsageArray.length-1).patchValue(s)}),t.certificationUsageMetrics&&t.certificationUsageMetrics.forEach(s=>{this.addCertificationUsage(),this.certificationUsageArray.at(this.certificationUsageArray.length-1).patchValue(s)})}get promotionalUsageArray(){return this.form.get("promotionalUsageMetrics")}get certificationUsageArray(){return this.form.get("certificationUsageMetrics")}get successStoriesArray(){return this.form.get("impactAssessment.successStories")}get challengesArray(){return this.form.get("impactAssessment.challengesFaced")}addPromotionalUsage(){const t=this.fb.group({mediaCampaignName:["",[n.k0.required]],mediaTypeReported:["",[n.k0.required]],markUsed:["",[n.k0.required]],usagePeriodStart:["",[n.k0.required]],usagePeriodEnd:["",[n.k0.required]],audienceReached:[""],impressions:[""],engagementMetrics:[""],campaignCost:[""]});this.promotionalUsageArray.push(t)}removePromotionalUsage(t){this.promotionalUsageArray.removeAt(t)}addCertificationUsage(){const t=this.fb.group({sector:["",[n.k0.required]],certificationsIssued:["",[n.k0.required]],markAppearances:["",[n.k0.required]],clientFeedback:[""],nonConformities:["",[n.k0.required]],correctiveActions:[""]});this.certificationUsageArray.push(t)}removeCertificationUsage(t){this.certificationUsageArray.removeAt(t)}addSuccessStory(){this.successStoriesArray.push(this.fb.control("",[n.k0.required]))}removeSuccessStory(t){this.successStoriesArray.removeAt(t)}addChallenge(){this.challengesArray.push(this.fb.control("",[n.k0.required]))}removeChallenge(t){this.challengesArray.removeAt(t)}onSupportingEvidenceSelected(t,s){const o=t.target.files[0];o&&this.supportingEvidenceFiles.push({file:o,type:s})}removeSupportingEvidence(t){this.supportingEvidenceFiles.splice(t,1)}onSampleSelected(t,s){const o=t.target.files[0];o&&this.sampleFiles.push({file:o,type:s})}removeSample(t){this.sampleFiles.splice(t,1)}onTestimonialSelected(t){const s=Array.from(t.target.files);this.testimonialFiles=[...this.testimonialFiles,...s]}removeTestimonial(t){this.testimonialFiles.splice(t,1)}saveDraft(){if(this.form.invalid)return this.markFormGroupTouched(this.form),void(this.error="Please fill in all required fields correctly.");this.saving=!0,this.error="";const s={...this.form.getRawValue(),supportingEvidence:this.supportingEvidenceFiles.map(a=>({fileName:a.file.name,evidenceType:a.type})),samples:this.sampleFiles.map(a=>({fileName:a.file.name,materialType:a.type})),testimonials:this.testimonialFiles.map(a=>({fileName:a.name}))};(this.existingReport?this.reportService.updateReport(this.existingReport.id,s):this.reportService.createReport(s)).pipe((0,p.j)(()=>{this.saving=!1})).subscribe({next:a=>{this.existingReport=a,this.success=!0,this.successMessage="Report saved as draft successfully.",setTimeout(()=>{this.success=!1},3e3)},error:a=>{this.error=a.error?.message||"Failed to save report. Please try again."}})}submitReport(){if(this.form.invalid)return this.markFormGroupTouched(this.form),void(this.error="Please fill in all required fields correctly before submitting.");this.existingReport?(this.submitting=!0,this.error="",this.reportService.submitReport(this.existingReport.id).pipe((0,p.j)(()=>{this.submitting=!1})).subscribe({next:()=>{this.success=!0,this.successMessage="Report submitted successfully!",setTimeout(()=>{this.router.navigate(["/mark-licenses/dashboard"])},2e3)},error:t=>{this.error=t.error?.message||"Failed to submit report. Please try again."}})):this.error="Please save the report as draft first."}markFormGroupTouched(t){Object.keys(t.controls).forEach(s=>{const o=t.get(s);o?.markAsTouched(),o instanceof n.gE?this.markFormGroupTouched(o):o instanceof n.Yp&&o.controls.forEach(a=>{a instanceof n.gE?this.markFormGroupTouched(a):a.markAsTouched()})})}static{this.\u0275fac=function(s){return new(s||r)(e.rXU(n.ok),e.rXU(_.o),e.rXU(k.G),e.rXU(u.nX),e.rXU(u.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-mark-usage-report"]],decls:12,vars:5,consts:[[1,"w-full","max-w-6xl","mx-auto"],[1,"bg-white","rounded-xl","shadow-sm","border","border-slate-200","overflow-hidden"],[1,"px-8","py-6","border-b","border-slate-100","bg-slate-50/50"],[1,"text-2xl","font-bold","text-slate-900"],[1,"mt-1","text-sm","font-medium","text-slate-600"],["class","mt-1 text-sm text-slate-500",4,"ngIf"],["class","mx-8 mt-6 p-4 bg-emerald-50 border border-emerald-200 rounded-lg text-emerald-800",4,"ngIf"],["class","mx-8 mt-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800",4,"ngIf"],["class","p-8 space-y-10",3,"formGroup",4,"ngIf"],["class","p-8 text-center",4,"ngIf"],[1,"mt-1","text-sm","text-slate-500"],[1,"mx-8","mt-6","p-4","bg-emerald-50","border","border-emerald-200","rounded-lg","text-emerald-800"],[1,"font-semibold"],[1,"mx-8","mt-6","p-4","bg-red-50","border","border-red-200","rounded-lg","text-red-800"],[1,"p-8","space-y-10",3,"formGroup"],[1,"space-y-6"],[1,"text-lg","font-bold","text-slate-900","border-b","border-slate-200","pb-3"],[1,"grid","gap-6","md:grid-cols-2"],[1,"space-y-2"],["for","reportPeriodStart",1,"block","text-sm","font-semibold","text-slate-700"],[1,"text-red-500"],["type","date","id","reportPeriodStart","formControlName","reportPeriodStart",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["for","reportPeriodEnd",1,"block","text-sm","font-semibold","text-slate-700"],["type","date","id","reportPeriodEnd","formControlName","reportPeriodEnd",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["for","nsbContactName",1,"block","text-sm","font-semibold","text-slate-700"],["type","text","id","nsbContactName","formControlName","nsbContactName",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["for","nsbContactEmail",1,"block","text-sm","font-semibold","text-slate-700"],["type","email","id","nsbContactEmail","formControlName","nsbContactEmail",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],[1,"space-y-4"],[1,"flex","justify-between","items-center"],[1,"block","text-sm","font-semibold","text-slate-700"],["type","button",1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","text-sm",3,"click"],["formArrayName","promotionalUsageMetrics",1,"space-y-4"],["class","p-4 bg-slate-50 rounded-lg border border-slate-200 space-y-4",3,"formGroupName",4,"ngFor","ngForOf"],["formArrayName","certificationUsageMetrics",1,"space-y-4"],["class","p-4 bg-green-50 rounded-lg border border-green-200 space-y-4",3,"formGroupName",4,"ngFor","ngForOf"],["formGroupName","impactAssessment",1,"space-y-6"],[1,"grid","gap-4","md:grid-cols-2"],["type","text","formControlName","awarenessIncrease","placeholder","e.g., 30%",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","inquiriesReceived",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","partnershipsFormed",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","mediaCoverage",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["formArrayName","successStories",1,"space-y-2"],["class","flex gap-2",4,"ngFor","ngForOf"],["formArrayName","challengesFaced",1,"space-y-2"],["formGroupName","complianceChecks",1,"p-4","bg-slate-50","rounded-lg","border","border-slate-200","space-y-3"],[1,"flex","items-center","space-x-2","cursor-pointer"],["type","checkbox","formControlName","usedMarksOnlyAsAuthorized",1,"rounded","border-slate-300","text-blue-600"],[1,"text-sm","text-slate-700"],["type","checkbox","formControlName","followedBrandGuidelines",1,"rounded","border-slate-300","text-blue-600"],["type","checkbox","formControlName","didNotModifyMarks",1,"rounded","border-slate-300","text-blue-600"],["type","checkbox","formControlName","usedCurrentVersionOfMarks",1,"rounded","border-slate-300","text-blue-600"],["for","nonComplianceIssues",1,"block","text-sm","font-semibold","text-slate-700"],["id","nonComplianceIssues","formControlName","nonComplianceIssues","rows","3","placeholder","Describe any non-compliance issues encountered",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["for","correctiveActionsTaken",1,"block","text-sm","font-semibold","text-slate-700"],["id","correctiveActionsTaken","formControlName","correctiveActionsTaken","rows","3","placeholder","Describe corrective actions taken",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["for","plannedUsageNextYear",1,"block","text-sm","font-semibold","text-slate-700"],["id","plannedUsageNextYear","formControlName","plannedUsageNextYear","rows","4","placeholder","Describe planned usage for the next reporting period",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["for","renewalIntention",1,"block","text-sm","font-semibold","text-slate-700"],["id","renewalIntention","formControlName","renewalIntention",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm","focus:border-blue-600","focus:ring-1","focus:ring-blue-600","focus:outline-none"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["class","mt-2 space-y-2",4,"ngIf"],["type","file","multiple","","accept",".pdf,.doc,.docx",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm",3,"change"],[1,"flex","gap-4","justify-end","pt-6","border-t","border-slate-200"],["type","button",1,"px-6","py-2.5","bg-slate-600","text-white","rounded-lg","hover:bg-slate-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"disabled","click"],[4,"ngIf"],["type","button",1,"px-6","py-2.5","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"disabled","click"],[1,"p-4","bg-slate-50","rounded-lg","border","border-slate-200","space-y-4",3,"formGroupName"],[1,"font-semibold","text-slate-900"],["type","button",1,"text-red-600","hover:text-red-800","text-sm",3,"click"],["type","text","formControlName","mediaCampaignName",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["formControlName","mediaTypeReported",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["formControlName","markUsed",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","date","formControlName","usagePeriodStart",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","date","formControlName","usagePeriodEnd",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],[1,"grid","gap-4","md:grid-cols-3"],["type","text","formControlName","audienceReached",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","impressions",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","campaignCost",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["formControlName","engagementMetrics","rows","2","placeholder","e.g., clicks, shares, inquiries",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],[3,"value"],[1,"p-4","bg-green-50","rounded-lg","border","border-green-200","space-y-4",3,"formGroupName"],["type","text","formControlName","sector",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","certificationsIssued",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","markAppearances",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["formControlName","clientFeedback","rows","2",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","text","formControlName","nonConformities",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["formControlName","correctiveActions","rows","2",1,"w-full","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],[1,"flex","gap-2"],["rows","2",1,"flex-1","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm",3,"formControlName"],["type","button",1,"px-3","py-2","text-red-600","hover:text-red-800",3,"click"],[1,"w-64","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm"],["type","file","accept",".pdf,.jpg,.jpeg,.png",1,"flex-1","rounded-lg","border","border-slate-300","bg-white","px-3","py-2.5","text-sm",3,"change"],[1,"mt-2","space-y-2"],["class","flex items-center justify-between p-2 bg-slate-50 rounded",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-2","bg-slate-50","rounded"],[1,"p-8","text-center"],[1,"text-slate-600"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4,"Annual Mark Usage Report"),e.k0s(),e.j41(5,"p",4),e.EFF(6,"Form NSB-004-3: Annual Report on ARSO Mark Usage"),e.k0s(),e.DNE(7,h,2,1,"p",5),e.k0s(),e.DNE(8,v,3,1,"div",6),e.DNE(9,F,2,1,"div",7),e.DNE(10,Y,165,17,"form",8),e.DNE(11,V,3,0,"div",9),e.k0s()()),2&s&&(e.R7$(7),e.Y8G("ngIf",o.agreement),e.R7$(1),e.Y8G("ngIf",o.success),e.R7$(1),e.Y8G("ngIf",o.error),e.R7$(1),e.Y8G("ngIf",!o.loading),e.R7$(1),e.Y8G("ngIf",o.loading))},dependencies:[m.Sq,m.bT,n.qT,n.xH,n.y7,n.me,n.Zm,n.wz,n.BC,n.cb,n.j4,n.JD,n.$R,n.v8],styles:["[_nghost-%COMP%]{display:block;width:100%}section[_ngcontent-%COMP%]{scroll-margin-top:2rem}.array-item[_ngcontent-%COMP%]{transition:all .2s ease}.array-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px #0000001a}.file-upload-area[_ngcontent-%COMP%]{border:2px dashed #cbd5e1;border-radius:.5rem;padding:1.5rem;text-align:center;transition:all .2s ease}.file-upload-area[_ngcontent-%COMP%]:hover{border-color:#3b82f6;background-color:#eff6ff}.loading-spinner[_ngcontent-%COMP%]{display:inline-block;width:1rem;height:1rem;border:2px solid #e5e7eb;border-top-color:#3b82f6;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.success-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideDown .3s ease}@media (max-width: 768px){.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return r})();const X=[{path:"new/:licenseId",component:b},{path:":id",component:b}];let B=(()=>{class r{static{this.\u0275fac=function(s){return new(s||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[m.MD,n.X1,u.iI.forChild(X)]})}}return r})()}}]);